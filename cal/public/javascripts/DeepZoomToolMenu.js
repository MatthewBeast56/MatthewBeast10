// DeepZoomToolMenu.js 8.14 Mon Sep 23 2019 13:52:02 GMT-0700 (Pacific Daylight Time)
"use strict";var DeepZoomToolMenu=function(a){if(a){if(0===$("#drawingToolBar").length)return;var b=$("<button>",{id:"deepZoomTools",html:"<i class='icon-reorder'></i>",class:"btn"});$("#header .navbar-inner .container #header_left").append(b),this._checkToolCount(),$(window).trigger("resize")}};DeepZoomToolMenu.prototype._checkToolCount=function(a){var b=this._countTools(),c=$("#deepZoomTools");0===b?c.addClass("disabled"):c.on("click",$.proxy(this._prepareDeepZoomTools,this))},DeepZoomToolMenu.prototype._countTools=function(){for(var a=$("#drawingToolBar [toolid]").length,b=["#dropdown_magnifier","#dropdown_lineReader","#dropdown_readerMode","#dropdown_tutorial","#exhibitsToggle","#aslToggle","#ttsPlay"],c=0;c<b.length;c++)$(b[c]).length>0&&a++;var d=$("#btnOverview");d.length>0&&!d.hasClass("hide")&&a++;var e=$("#btnFlagForReview");return e.length>0&&!e.hasClass("hide")&&a++,a},DeepZoomToolMenu.prototype._prepareDeepZoomTools=function(){this._proxyBookmarkButton(),this._proxyReviewButton(),this._proxyUserMenuToggleItem({el:"#dropdown_magnifier",proxyId:"dzMagnifierButton",icon:"icon-search",title:"Magnifier",titleKey:"settings:magnifierLabel"}),this._proxyUserMenuToggleItem({el:"#dropdown_lineReader",proxyId:"dzLineReaderButton",icon:"icon-tasks",title:"Line Reader",titleKey:"settings:lineReaderLabel"}),this._proxyAnswerMaskingButton(),this._proxyUserMenuToggleItem({el:"#dropdown_readerMode",proxyId:"dzReaderModeButton",icon:"icon-align-justify",title:"Readable Mode",titleKey:"tools:readerMode"}),this._proxySimpleButton({el:"#dropdown_tutorial",proxyId:"dzTutorialButton",icon:"icon-question-sign",title:"Tutorial",titleKey:"settings:tutorialLabel"}),this._proxySimpleButton({el:"#exhibitsToggle",proxyId:"dzExhibitsButton",icon:"icon-folder-close",title:"Exhibits",titleKey:"exhibit:exhibits"}),this._proxySimpleButton({el:"#aslToggle",proxyId:"dzAslToggle",icon:"icon-film",title:"ASL Video Player",titleKey:"tts:aslVideoPlayer"}),this._addDeepZoomTTSItem(),$(document).trigger("deepZoomLayer.setCoupling",{title:'<i class="icon-reorder"></i>',html:"#drawingToolBar",specialCare:$.proxy(this._deepZoomSpecialCare,this),closeButtons:["button:not(#dzBookmarkButton):not(#dzTTS)"]})},DeepZoomToolMenu.prototype._proxyReviewButton=function(){var a=$("#btnOverview");if(a.length>0&&!a.hasClass("hide")){var b=this._makeProxyButton({proxyId:"dzReviewButton",icon:"icon-list-ul",title:"Review",titleKey:"generalWords:review"});a.hasClass("disabled")&&b.addClass("disabled"),$("#drawingToolBar").prepend(b)}},DeepZoomToolMenu.prototype._proxyBookmarkButton=function(){var a=$("#btnFlagForReview");if(a.length>0&&!a.hasClass("hide")){var b=this._makeProxyButton({proxyId:"dzBookmarkButton",icon:"icon-bookmark-empty",title:"Bookmark",titleKey:"header:bookmark"},DeepZoomToolMenuTemplates.deepZoomBookmarkButton);$("#drawingToolBar").prepend(b),this._syncBookmarkButtonState()}},DeepZoomToolMenu.prototype._proxyAnswerMaskingButton=function(){var a=$("#dropdown_ansmask");if(a.length>0){var b="none"!==a.parent().css("display"),c=a.children("i.icon-ok").length>0,d=this._makeProxyButton({proxyId:"dzAnswerMaskingButton",icon:"icon-eye-open",title:"Answer Masking",titleKey:"settings:answerMaskerLabel",hasOkay:!0});c&&d.addClass("active"),b&&$("#drawingToolBar").append(d)}},DeepZoomToolMenu.prototype._proxyUserMenuToggleItem=function(a){var b=$(a.el);if(b.length>0){var c=b.children("i.icon-ok").length>0;a.hasOkay=!0;var d=this._makeProxyButton(a);c&&d.addClass("active"),$("#drawingToolBar").append(d)}},DeepZoomToolMenu.prototype._proxySimpleButton=function(a){var b=$(a.el);if(b.length>0){var c=this._makeProxyButton(a);$("#drawingToolBar").append(c)}},DeepZoomToolMenu.prototype._addDeepZoomTTSItem=function(){if($("#ttsPlay").length>0){var a=this._makeProxyButton({proxyId:"dzTTS",icon:"icon-play",title:"Text to Speech",titleKey:"tutorial:ttsTitle"});$("#drawingToolBar").append(a)}},DeepZoomToolMenu.prototype._makeProxyButton=function(a,b){b||(b=DeepZoomToolMenuTemplates.deepZoomToolButton),a.hasOwnProperty("titleKey")&&(a.title=$.i18n?$.i18n.t(a.titleKey):a.title),a.hasOwnProperty("hasOkay")||(a.hasOkay=!1);var c=$(template(b,a));return c},DeepZoomToolMenu.prototype._deepZoomSpecialCare=function(){for(var a=$("#drawingToolBar .btn[title]"),b=0;b<a.length;b++){var c=$("<span>",{text:$(a[b]).data("original-title"),class:"deepZoomHtml"});$(a[b]).append(c).append('<i class="deepZoomHtml icon-ok"></i>')}this._proxyUserMenuClick("#dzReviewButton","#btnOverview button"),this._proxyBookmarkClick(),this._proxyUserMenuClick("#dzExhibitsButton","#exhibitsToggle"),this._proxyUserMenuClick("#dzAnswerMaskingButton","#dropdown_ansmask"),this._proxyUserMenuClick("#dzLineReaderButton","#dropdown_lineReader"),this._proxyUserMenuClick("#dzMagnifierButton","#dropdown_magnifier"),this._proxyUserMenuClick("#dzTutorialButton","#dropdown_tutorial"),this._proxyUserMenuClick("#dzReaderModeButton","#dropdown_readerMode"),this._proxyUserMenuClick("#dzAslToggle","#aslToggle"),this._handleDeepZoomTTS()},DeepZoomToolMenu.prototype._proxyUserMenuClick=function(a,b){$(a).on("click",function(){$(a).hasClass("disabled")||$(b).trigger("click")})},DeepZoomToolMenu.prototype._proxyBookmarkClick=function(){var a=$("#btnFlagForReview"),b=$("#dzBookmarkButton"),c=this;b.on("click",function(){a.trigger("click"),c._syncBookmarkButtonState()})},DeepZoomToolMenu.prototype._syncBookmarkButtonState=function(){var a=$("#btnFlagForReview"),b=$("#dzBookmarkButton");a.hasClass("active")?b.children(".bookmark-sprite").removeClass("hidden"):b.children(".bookmark-sprite").addClass("hidden")},DeepZoomToolMenu.prototype._handleDeepZoomTTS=function(){$("#dzTTS").on("click",$.proxy(this._handleDeepZoomTTSMenuClick,this))},DeepZoomToolMenu.prototype._handleDeepZoomTTSMenuClick=function(){$("#deepZoomClose").trigger("click"),this._buildDeepZoomTTSMenu()},DeepZoomToolMenu.prototype._buildDeepZoomTTSMenu=function(){var a=$('<div id="dzTtsControls" class="btn-group deepZoomOnly deepZoomHtml"></div>');this._makeDeepZoomTTSControlProxy("#ttsPlay","dzTtsPlay",a),this._makeDeepZoomTTSControlProxy("#ttsCTH","dzTtsCTH",a),this._makeDeepZoomTTSControlProxy("#ttsStop","dzTtsStop",a),$("#ttsSettingsPanel").prepend(a);var b=$.i18n?$.i18n.t("tutorial:ttsTitle"):"Text to Speech";$(document).trigger("deepZoomLayer.setCoupling",{title:'<i class="icon-play"></i> '+b,html:"#ttsSettingsPanel",specialCare:$.proxy(this._deepZoomTTSSpecialCare,this)})},DeepZoomToolMenu.prototype._makeDeepZoomTTSControlProxy=function(a,b,c){var d=$(a);if(d.length>0){var e=$(d[0].outerHTML);e.attr("id",b),c.append(e)}},DeepZoomToolMenu.prototype._deepZoomTTSSpecialCare=function(){this._proxyTtsControlClick("#dzTtsPlay","#ttsPlay"),this._proxyTtsControlClick("#dzTtsCTH","#ttsCTH",this._updateClickToHearButtonState),this._proxyTtsControlClick("#dzTtsStop","#ttsStop"),$("#deepZoomLayerBody #ttsSettingsPanel [tabindex=-1]").attr("tabindex",0),$(document).off("TTS.playButton",this._handleDeepZoomTTSPlay).on("TTS.playButton",this._handleDeepZoomTTSPlay)},DeepZoomToolMenu.prototype._handleDeepZoomTTSPlay=function(a,b,c){var d=$("#dzTtsPlay"),e=d.find("i.icon-white");"play"===b?(d.addClass("playing"),"myna"===c&&(d.addClass("active").removeClass("btn-inverse"),e.removeClass("icon-play").addClass("icon-pause"))):(d.removeClass("playing"),"myna"===c&&(d.removeClass("active").addClass("btn-inverse"),e.addClass("icon-play").removeClass("icon-pause")))},DeepZoomToolMenu.prototype._proxyTtsControlClick=function(a,b,c){var d=$(b),e=$(a);d.length>0&&e.on("click",function(){d.trigger("click"),c&&c(e,d)})},DeepZoomToolMenu.prototype._updateClickToHearButtonState=function(a,b){b.hasClass("active")?(a.addClass("active"),a.removeClass("btn-inverse")):(a.removeClass("active"),a.addClass("btn-inverse"))},DeepZoomToolMenu.prototype.destroy=function(){$("#deepZoomTools").off("click",$.proxy(this._prepareDeepZoomTools,this)),$("#header .navbar-inner #deepZoomTools").remove()};var DeepZoomToolMenuTemplates={};DeepZoomToolMenuTemplates.deepZoomBookmarkButton='<button class="btn deepZoomOnly deepZoomHtml" id="<%=proxyId%>">\n    <i class="<%=icon%>"></i> <%=title%>\n    <span class="bookmark-sprite hidden"></span>\n</button>\n',DeepZoomToolMenuTemplates.deepZoomToolButton='<button class="btn deepZoomOnly deepZoomHtml" id="<%=proxyId%>">\n    <i class="<%=icon%>"></i> <%=title%>\n    <% if( hasOkay ) {%>\n        <i class="icon-ok"></i>\n    <% } %>\n</button>';
