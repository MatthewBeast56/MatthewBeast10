/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */

define("SequentialNavigator",["require","exports"],function(e,t){var n=function(){function e(e){this._section=e}return this._section,this._blockedItems,e.prototype.setFirstItemCallback=function(e,t,n,i){$(document).trigger("inform.gotCurResponse"),$(document).trigger("inform.gotCatItem");var s=window.TestEngine;({success:"yes",item:e.getFirstItem().getIdentifier()});if(null!==n&&(this._blockedItems=n.map(function(e){return e.itemId})),window.TestEngine.getTestDefine().scoreItems()&&!window.TestEngine.getTestDefine().isScoringServiceConfigRetrieved()){var r=function(n){if(!n||n&&!n.catUrl)if(n.success&&"no"===n.success)t.call(s,n);else{var i={success:"no",msg:n};t.call(s,i)}else{window.TestEngine.getTestDefine().setScoringServiceConfigRetrieved(!0);var r=window.TN8.TestStateController.getTestStateRoot();r&&r.set("scoringSessionToken",n.session_token);var o=function(n){t.call(s,{success:"yes",item:e.getFirstItem().getIdentifier()})},a=TN8.TestStateController.assembleTestState();a.rl||(a.rl={},e.getFirstItem()&&(a.rl.lastItem=e.getFirstItem().getIdentifier())),a.rl.location="item",window.TestEngine._state.setTestState(window.TestEngine.selectedTestId,a,o,!1)}},o=function(e){t.call(s,e)};this.retrieveScoringURL(e,r,o)}else{var a;if(void 0!==i&&null!==i)a=i;else{for(var c=e.getFirstItem();c&&this._blockedItems&&this._blockedItems.length>0&&this._blockedItems.indexOf(c.getIdentifier())!==-1;)c=c.getNextSibling();a=c?c.getIdentifier():null}t.call(s,{success:"yes",item:a})}},e.prototype.retrieveScoringURL=function(e,t,n){var i=window.TestEngine,s=i.getAuthentication().getLoginToken(),r=i.getAuthentication().getSessionToken(),o=void 0,a=window.TN8.TestStateController.getTestStateRoot();a&&(o=a.get("scoringSessionToken"));var c={u_sess:s,sess:r,formNumber:i.getAuthentication().getCurrentForm().getNumber(),formVersion:1,sectionNumber:e.getIdentifier(),session_token:o,sectionOrder:window.TestEngine.getTestDefine().getTestParts()[0].getSectionIndexById(e.getIdentifier())+1+"",sessionType:"linear"};window.TestEngine._serverInterface.getCATConfig(c,t,n,window)},e.prototype.setNextItemIdCallback=function(e,t){$(document).trigger("inform.gotCatItem");for(var n=window.TestEngine,i=n._navigation,s=i.getCurrentItem(),r=s.getNextSibling();r&&this._blockedItems&&this._blockedItems.length>0&&this._blockedItems.indexOf(r.getIdentifier())!==-1;)r=r.getNextSibling();var o=r?r.getIdentifier():null,a={success:"yes",item:o,response:e};t.call(n,a)},e.prototype.setPrevItemIdCallback=function(e,t){$(document).trigger("inform.gotCatItem");for(var n=window.TestEngine,i=n._navigation,s=i.getCurrentItem(),r=s.getPreviousSibling();r&&this._blockedItems&&this._blockedItems.length>0&&this._blockedItems.indexOf(r.getIdentifier())!==-1;)r=r.getPreviousSibling();var o=r?r.getIdentifier():null,a={success:"yes",item:o,response:e};t.call(n,a)},e.prototype.setItemIdCallback=function(e,t,n){$(document).trigger("inform.gotCatItem");var i=window.TestEngine,s=window.TestEngine.getNavigation().getCurrentSection(),r=s.getChildById(t).getIdentifier();this._blockedItems&&this._blockedItems.length>0&&this._blockedItems.indexOf(r)!==-1&&(r=null);var o={success:"yes",item:r,response:e};n.call(i,o)},e.prototype.setResumedItemIdCallback=function(e,t,n){$(document).trigger("inform.gotCurResponse"),$(document).trigger("inform.gotCatItem");var i=window.TestEngine;void 0!==n&&(this._blockedItems=n.map(function(e){return e.itemId}));var s=this.getResumeItemFromSection();({success:"yes",item:s.getIdentifier(),section:e});if(window.TestEngine.getTestDefine().scoreItems()&&!window.TestEngine.getTestDefine().isScoringServiceConfigRetrieved()){var r=function(n){if(!n||n&&!n.catUrl)if(n.success&&"no"===n.success)t.call(i,n);else{var r={success:"no",msg:n};t.call(i,r)}else{window.TestEngine.getTestDefine().setScoringServiceConfigRetrieved(!0);var o=window.TN8.TestStateController.getTestStateRoot();o&&o.set("scoringSessionToken",n.session_token),t.call(i,{success:"yes",item:s.getIdentifier(),section:e})}},o=function(e){t.call(i,e)};this.retrieveScoringURL(e,r,o)}else t.call(i,{success:"yes",item:s.getIdentifier(),section:e})},e.prototype.setLastItemIdCallback=function(e,t){$(document).trigger("inform.gotCatItem");for(var n=window.TestEngine,i=window.TestEngine.getNavigation().getCurrentSection(),s=i.getAssessmentItemRefs().slice(-1)[0];s&&this._blockedItems&&this._blockedItems.length>0&&this._blockedItems.indexOf(s.getIdentifier())!==-1;)s=s.getPreviousSibling();var r={success:"yes",item:s?s.getIdentifier():null,response:e};t.call(n,r)},e.prototype.getResumeItemFromSection=function(){if(window.TN8.TestStateController.getResumeLocationOverall()){var e=window.TN8.TestStateController.getResumeLocationOverall().lastItem,t=TestEngine.getNavigation().getCurrentTestPart().getItemById(e);return t}},e.prototype.scoreItem=function(e,t,n,i){var s=window.TN8.TestStateController.getTestStateRoot(),r="scoring/item/"+s.get("scoringSessionToken")+"/score",o=window.TestEngine._navigation.getCurrentItem().getItemName(),a={externalItemId:o,itemAnswer:e},c=function(e){e.success="yes",n.call(window.TestEngine,e)},u=function(e){i.call(window.TestEngine,{success:"no",msg:e})};a&&(a=window.TestEngine._native.compressContent(JSON.stringify(a))),window.TestEngine._serverInterface.scoreResponse(r,a,c,u,window)},e.prototype.getCorrectTestCases=function(e,t){var n=window.TestEngine.getAuthentication().getCurrentForm()._id,i=window.TestEngine._navigation.getCurrentItem()._identifier,s="previewer/api/score/form/"+n+"/item/"+i+"/getCorrectItemScoringTestcases",r=function(t){t.success="yes",e.call(window.TestEngine,t)},o=function(e){t.call(window.TestEngine,{success:"no",msg:e})};window.TestEngine._serverInterface.getCorrectTestCases(s,r,o,window)},e.prototype.scoreFeedback=function(e,t,n){var i=window.TestEngine.getAuthentication().getCurrentForm()._id,s="previewer/api/score/form/"+i+"/itemsByIdentifier",r={items:[]},o=window.TestEngine._navigation.getCurrentItem(),a=o.getItemName(),c=o._identifier,u={itemRef:{id:c,externalItemId:a},state:{mods:[]}},l=[];e.forEach(function(e,t){var n={};n.did=e.id.replace("_feedback",""),n.r=e.response,l.push(n)}),u.state.mods=l,r.items.push(u);var d=JSON.stringify(r),g=function(e){e.success="yes",t.call(window.TestEngine,e)},p=function(e){n.call(window.TestEngine,{success:"no",msg:e})};window.TestEngine._serverInterface.scoreFeedback(s,d,g,p,window)},e.prototype.getItemListToPreload=function(){var e=window.TestEngine._navigation,t=new Array,n=e._currentSection,i=e.getCurrentItem().getNextSibling();if(!i){for(var s=n.getNextSibling();s&&!s.isLinear();)s=s.getNextSibling();if(!s)return null;i=s.getFirstItem()}return!i||i.isPreloaded()||i.isPreloadInProgress()||t.push(i),t},e.prototype.getItemOrder=function(e){var t=window.TestEngine.getNavigation().getCurrentSection();return t.getIndexOfItem(t.getChildById(e))},e.prototype.hasSectionEnded=function(){return!1},e}();t.SequentialNavigator=n}),define("AdaptiveNavigator",["require","exports"],function(e,t){var n=function(){function e(e){this._section=e,this._preloadItemArray=new Array,this._itemOrderMap=new Object}return this._section,this._preloadItemArray,e.prototype.setFirstItemCallback=function(e,t,n,i){$(document).trigger("inform.gotCurResponse");var s=window.TestEngine._navigation.getNavigator(e),r=function(e){t.call(s,e)},o=function(n){if(!n||n&&!n.catUrl)if(n.success&&"no"===n.success)t.call(s,n);else{var i={success:"no",msg:n};t.call(s,i)}else{e.setSessionToken(n.session_token);var r=TN8.TestStateController.assembleTestState();r.rl||(r.rl={},e.getFirstItem()&&(r.rl.lastItem=e.getFirstItem().getIdentifier())),r.rl.location="item",window.TestEngine._state.setTestState(window.TestEngine.selectedTestId,r,$.proxy(s.setNextItemIdCallback,s,null,t),!1)}};s.retrieveCATURL(e,o,r)},e.prototype.setNextItemIdCallback=function(e,t,n,i){this.setNavigateItemIdCallback(e,t,n,i,"next")},e.prototype.setPrevItemIdCallback=function(e,t,n){this.setNavigateItemIdCallback(e,t,!1,n,"previous")},e.prototype.setItemIdCallback=function(e,t,n,i){var s=i;s||(s=window.TestEngine.getNavigation().getCurrentSection()),this.setNavigateItemIdCallback(e,n,!1,s,s.getChildById(t).getItemName())},e.prototype.prepNavigateData=function(e,t,n,i,s){var r=e.getNavigation().getCurrentSection(),o={};"toItem"===i?i=r.getChildById(s).getItemName():"prev"===i&&(i="previous"),o=this._constructNavigateRequestData(e,o,t,r,i),o.navigateToken=(new Date).getTime(),this._successOnNextItem(t,n,!1,r,o,!0)},e.prototype._successOnNextItem=function(e,t,n,i,s,r){if(!s||s&&void 0===s.items)if(s.success&&"no"===s.success)s.msgCode=window.TestEngine._getTranslatedErrorMsgCode(s.msgCode),t.call(this,s);else{var o={success:"no",msg:s};t.call(this,o)}else{var a=new Object;a.index=s.index,!s.prevItems||null===s.prevItems&&void 0===s.prevItems||(a.prevItems=s.prevItems),!s.sessionId||null===s.sessionId&&void 0===s.sessionId||(a.sessionId=s.sessionId),!s.index||null===s.index&&void 0===s.index||(a.index=s.index),!i.getCATData()||void 0!==s.index&&null!==s.index||(a.index=i.getCATData().index+1),i.setCATData(a);var c=null,u=null;if(s.items&&s.items.length>0&&(c=i.getItemByName(s.items[0].itemId),u=c?c.getIdentifier():s.items[0].itemId),c&&(this._itemOrderMap[c.getIdentifier()]=a.index+1),s.preloadItemList&&s.preloadItemList.length>0)for(j=0;j<s.preloadItemList.length;j++){var l=i.getItemByName(s.preloadItemList[j]);l&&this._preloadItemArray.push(l)}var o={success:"yes"};for(var d in s)o[d]=s[d],"reviewFlag"===d&&(o.reviewFlag=s.items?s.items[0].review_flag:null);if(void 0!==e&&(o.response=e),n&&(o.reviewFlag=s.review_flag,o.section=i),o.item=u,s.adaptiveStateData&&i.setAdaptiveState(s.adaptiveStateData),!s.items)return this.sectionEnded=!0,$(document).trigger("inform.gotCatItem"),void t.call(this,o,!0);r||$(document).trigger("inform.gotCatItem"),t.call(this,o,!0)}},e.prototype._constructNavigateRequestData=function(e,t,n,i,s){var r=n.mods[0].id,o=i.getAssessmentItemRefById(r),a=o.getItemName(),c=o.getWc(),u=e._state.getItemVersion(r);return t={index:i.getCATData().index,items:[{itemId:a,response:n,isWC:c,version:u+1+"",itemOrder:this.getItemOrder(r)?this.getItemOrder(r):i.getCATData().index+1,timeStamp:(new Date).getTime()}],prevItems:null,sessionToken:i.getSessionToken(),navigate_to:s,section_name:i.getIdentifier()},i.getCATData().prevItems&&(t.prevItems=i.getCATData().prevItems),i.getCATData().sessionId&&(t.sessionId=i.getCATData().sessionId),t},e.prototype._addCatchUpItems=function(e,t){return t.catchUpItems=e._state.getBundlePrepared(),t},e.prototype._combineNavAndSaveData=function(e,t,n){var i=t;return delete i.success,delete i.studentId,delete i.testId,delete i.formId,delete i.item,delete i.score,$.extend(i,{test_state:n.data.test_state,ts:n.timestamp,u_sess:e._auth.getLoginToken(),sess:e._auth.getSessionToken(),version:++e._state._testStateVersion,remoteSectionControl:!!e.getNavigation().getCurrentSection()&&e.getNavigation().getCurrentSection().getRemoteSectionControl(),testnavEventQueue:e._testnavEventQueue,itemOrder:n.itemOrder,itemId:n.itemId}),i=this._addCatchUpItems(e,i),i.catchUpItems.pop(),i},e.prototype._navSaveSuccessWrapper=function(e,t,n,i,s,r){e._state._localItemCache.clearBundle(),e.clearResponseQueue(),s&&e._ewsRetrySucessfullCallback.call(e),this._successOnNextItem(void 0,t,n,i,r,!1)},e.prototype._navSaveErrorWrapper=function(e,t,n){n.msgCode&&n.msgCode!==TN8.errorType.CAT_NAVIGATE_TIMEOUT?(n.msgCode=e._getTranslatedErrorMsgCode(n.msgCode),t(n)):e.ewsError(e,'{"success":"no","errorcode":"1019","msg":"Unable to complete NavSave call."}',this._navSaveRetryMethod,this._navSaveRetryArgs)},e.prototype.navigateAndSave=function(e,t,n,i,s,r,o){var a={};a=this._combineNavAndSaveData(e,t,n),url="adaptive/navigate-save/"+e._auth.getLoginId(),a&&(a.navigateToken=(new Date).getTime(),a.items[0].isWC&&(a.items[0].response.wcProcessed=!0),a=e._native.compressContent(JSON.stringify(a)));var c=$.proxy(this._navSaveSuccessWrapper,this,e,i,!1,e.getNavigation().getCurrentSection());"function"!=typeof s&&(s=$.proxy(e.navSaveSRFCallback,e,this,i,null)),this._navSaveRetryMethod=$.proxy(e._serverInterface.navigateAndSaveCAT,e._serverInterface,url,a,$.proxy(c,this,!0),$.proxy(s,e,null),window),this._navSaveRetryArgs=[],s=$.proxy(s,e,this._navSaveRetryMethod),e._serverInterface.navigateAndSaveCAT(url,a,$.proxy(c,this,!1),s,window)},e.prototype.setNavigateItemIdCallback=function(e,t,n,i,s,r){var o=window.TestEngine,a=i;a||(a=o.getNavigation().getCurrentSection());var c={};null!==e&&void 0!==e&&(c=this._constructNavigateRequestData(o,c,e,a,s)),url="adaptive/navigate-save/"+o._auth.getLoginId(),c&&(c.navigateToken=(new Date).getTime(),c.sessionToken=a.getSessionToken(),c=this._addCatchUpItems(o,c),c.catchUpItems.length>0&&(c.test_state=TN8.TestStateController.getTestStateModel().getAll(!0),c.section_name=a.getIdentifier(),c.ts=(new Date).getTime(),c.u_sess=o._auth.getLoginToken(),c.sess=o._auth.getSessionToken(),c.version=++o._state._testStateVersion,c.items=null),c=o._native.compressContent(JSON.stringify(c)));var u=$.proxy(this._navSaveSuccessWrapper,this,o,t,n,a),l=$.proxy(this._navSaveErrorWrapper,this,o,t);this._navSaveRetryMethod=$.proxy(o._serverInterface.navigateAndSaveCAT,o._serverInterface),this._navSaveRetryArgs=[url,c,$.proxy(u,this,!0),l,window],o._serverInterface.navigateAndSaveCAT(url,c,$.proxy(u,this,!1),l,window)},e.prototype._checkBlockedItemsToSendResponse=function(e,t,n){var i=-1;t.forEach(function(e){e.itemId===n.lastItem&&(i=parseInt(e.itemId))});var s=null;return i!==-1&&e._state._localItemCache.forEach(function(e){e.itemId===i&&(s={},s[i]={state:e.state,timeStamp:e.timeStamp,version:e.version,itemOrder:e.itemOrder})}),s},e.prototype.setResumedItemIdCallback=function(e,t,n,i){$(document).trigger("inform.gotCurResponse");var s,r=window.TestEngine._navigation.getNavigator(e),o=function(e){t.call(r,e)},a=function(n){if(!n||n&&!n.catUrl)if(n.success&&"no"===n.success)t.call(r,n);else{var s={success:"no",msg:n};t.call(r,s)}else e.setSessionToken(n.session_token),i?t():r.setNextItemIdCallback(null,t,!0,e)};void 0!==n&&(s=n.map(function(t){return e.getAssessmentItemRefById(t.itemId).getItemName()})),r.retrieveCATURL(e,a,o,s)},e.prototype.retrieveCATURL=function(e,t,n,i){var s=window.TestEngine,r=s.getAuthentication().getLoginToken(),o=s.getAuthentication().getSessionToken(),a=e.getContinuedFromSectionId(),c=e.getSessionToken();if(a){var u=window.TestEngine.getTestDefine().getSectionById(a);c=u.getSessionToken()}var l={u_sess:r,sess:o,formNumber:s.getAuthentication().getCurrentForm().getNumber(),formVersion:1,sectionNumber:e.getIdentifier(),session_token:c,sectionOrder:window.TestEngine.getTestDefine().getTestParts()[0].getSectionIndexById(e.getIdentifier())+1+"",itemsWithResumeRestriction:i};window.TestEngine._serverInterface.getCATConfig(l,t,n,window)},e.prototype.getItemListToPreload=function(){for(var e=window.TestEngine._navigation.getNavigator(window.TestEngine.getNavigation().getCurrentSection()),t=new Array,n=0;n<e._preloadItemArray.length;n++){var i=e._preloadItemArray[n];!i||i.isPreloaded()||i.isPreloadInProgress()||t.push(i)}return e._preloadItemArray=new Array,t},e.prototype.getItemOrder=function(e){var t=window.TestEngine._navigation.getNavigator(window.TestEngine.getNavigation().getCurrentSection());return t._itemOrderMap[e]},e.prototype.hasSectionEnded=function(){var e=window.TestEngine._navigation.getNavigator(window.TestEngine.getNavigation().getCurrentSection());return e.sectionEnded},e}();t.AdaptiveNavigator=n}),define("Navigation",["require","exports","./SequentialNavigator","./AdaptiveNavigator"],function(e,t,n,i){var s=n,r=i;!function(e){var t=function(){function e(e,t,n,i){this._auth=n,this._apiBaseUrl=t,this._testEng=i,this._precacheComponent=new window.TestEngine.EventLib.EventEmitter,this._testInformation=e,this._currentTestPart=this._testInformation.getTestParts()[0],this._currentSection=this._testInformation.getTestParts()[0].getFirstSection(),this._currentItem=this._currentSection.getFirstItem(),this._initParPreloadSent=!1,this._initParPreloaded=!1,this._preloadCount=0,this._navigatorHolder=new Object,this._isItemRequestInProcess=!1,this._isResumedTest=!1,this._preloadUniqueResourceList=new Array}return e.ASSETS_READY="ItemAssetsReady",e.NAV_ERROR="NavigationError",e.SHOW_TEST_OVERVIEW="ShowTestOverview",e.SHOW_SECTION_OVERVIEW="ShowSectionOverview",e.prototype.precache=function(){var t=new window.TestEngine.EventLib.Event(e.ASSETS_READY,this._precacheComponent);this._precacheComponent.emitEvent(t)},e.prototype.getResumeSection=function(){var e=void 0;if(!window.TN8.TestStateController.getResumeLocationOverall())return e;var t=window.TN8.TestStateController.getResumeLocationOverall().lastItem;if(!t)return e;var n=window.TestEngine.getNavigation().getCurrentTestPart().getItemById(t);return n?e=n.getParent():e},e.prototype.navigateItem=function(e){return null!==e&&void 0!==e?this.gotoItem(e):(e=this._currentItem,console.log("Out of limit, going to section overview."),this.showSectionOverview(e.getParent())),e},e.prototype.navigateSection=function(e){return null!==e&void 0!==e?this.gotoSection(e):(e=this._currentSection,console.log("Out of limit, going to test overview."),this.showTestOverview(e.getParent())),e},e.prototype.navigateTestPart=function(e){return null!==e&void 0!==e?this.gotoTestPart(e):(e=this._currentTestPart,console.log("Out of limit, going to test overview."),this.showTestOverview(e)),e},e.prototype.canNavigate=function(){return!(this._currentSection.getMustAnswerToContinue()&&!this._currentItem.getAnswered())},e.prototype.nextItem=function(){if(!this.canNavigate()){var t=new window.TestEngine.EventLib.Event(e.NAV_ERROR,"Item must to answered to navigate.");return this.emitEvent(t),this._currentItem}var n=this._currentItem.getNextSibling();return this.navigateItem(n),this._currentItem},e.prototype.previousItem=function(){var e=this._currentItem.getPreviousSibling();return this.navigateItem(e),this._currentItem},e.prototype.gotoItem=function(e){this._currentItem=e},e.prototype.generateAjaxPostSettings=function(e,t,n){var i,s=this,r=window.TestEngine.getTestDefine()._securityLevel,o={};o.type="GET",o.context=this,o.dataType="json",o.timeout=6e5,o.success=t,o.error=function(e,t,n){i(e,t,n)};var a=function(){s.shouldStopPreloading()||window.TestEngine.ewsError(window.TestEngine,'{"success":"no","errorcode":"1009","msg":"Unable to load item content"}',window.TestEngine._navigation.getItemFlavor,[n,t])};return i=3!==r?function(t,n,i){s._auth.ajaxFailureCallback(t,n,i,o,"Navigation","getItemFlavor",e,a)}:function(n,i,r){s._auth.ajaxFailureCallback(n,i,r,o,"Navigation","getItemFlavor",e,t)},o},e.prototype.validateAndRectifyFlavor=function(e,t,n,i){var s=(window.TestEngine._navigation,JSON.stringify(e)),r=s.indexOf(t)!==-1;if(r){if(n.lastIndexOf("/")===n.length-1&&(n=n.substring(0,n.length-1)),r){var o=s.indexOf(t),a=s.substring(o,s.indexOf("/",o+t.length));a=i?a.replace(/\//g,"\\\\/"):a,s=s.replace(new RegExp(a,"g"),n)}e=JSON.parse(s)}return e},e.prototype.retrieveItemFromServer=function(e,t,n){var i=window.TestEngine._navigation;window.TestEngine.getDesiredFlavor(e);window.TestEngine._serverInterface.getItemFlavor(e,$.proxy(i.retrieveItemFromServerSuccess,i,window.TestEngine,t,n),$.proxy(i.retrieveItemFromServerFailure,i,window.TestEngine,e,t),i)},e.prototype.retrieveItemFromServerSuccess=function(e,t,n,i){if(n&&e._ewsRetrySucessfullCallback&&e._ewsRetrySucessfullCallback.call(this),!this.shouldStopPreloading()){if(3===parseInt(e._state._securityLevel)){var s=JSON.stringify(i),r=e._auth.getCurrentForm().getContentUrl(),o=r.replace("http","https");e.isUsingHttps()?(s=s.replace(new RegExp(r,"g"),o),s=s.replace(new RegExp("http://"+window.location.host,"g"),"https://"+window.location.host)):(s=s.replace(new RegExp(o,"g"),r),s=s.replace(new RegExp("https://"+window.location.host,"g"),"http://"+window.location.host)),i=JSON.parse(s)}else{var a=[];!e.isUsingHttps()||e._native.runInMixedMode()||e.isJXBrowserApp()?(a.push("http://localhost"),a.push("https://localhost")):a.push("http://localhost");for(var c=0;c<a.length;c++)i=this.validateAndRectifyFlavor(i,a[c],e._native.getSecureLocalUrl(),!1),i=this.validateAndRectifyFlavor(i,a[c].replace(/\//g,"\\\\/"),e._native.getSecureLocalUrl().replace(/\//g,"\\\\/")+"\\\\",!0)}t.call(e,i)}},e.prototype.retrieveItemFromServerFailure=function(e,t,n,i){3===parseInt(e._state._securityLevel)?n.call(e,{success:"no","msgCode:":TN8.errorType.HANDLER_FETCH_ERROR,msg:"Error in fetching item"}):e._navigation.shouldStopPreloading()||e.ewsError(e,'{"success":"no","errorcode":"1009","msg":"Unable to load item content","details":"Retrieve Failed for Item Id: '+t+'"}',e._navigation.retrieveItemFromServer,[t,n,!0])},e.prototype.getItemFlavor=function(e,t){var n=window.TestEngine._navigation;if(window.TestEngine.logError("TestEngine=>getItemFlavor itemID: "+n.getCurrentTestPart().getItemById(e).getIdentifier()),!n._testEng._native||n._testEng._native&&n._testEng._native.verifyWindowFullscreen(!0)&&n._testEng._native.verifySecureMove()){var i=window.TestEngine.getTestDefine()._securityLevel;if(3!==i){var n=n,s=n.getCurrentTestPart().getItemById(e);if(n._isItemRequestInProcess)return;n._isItemRequestInProcess=!0;var s=n._currentSection.getAssessmentItemRefById(e),r=function(i){window.TestEngine.logError("TestEngine=>getItemFlavor newlog: preloadCallbk "+s.getIdentifier());var r=function(e){t.call(n,e),n._isItemRequestInProcess=!1,s&&s.setPreloaded(),n.preload(null)};if(s.isPreloadInProgress()){window.TestEngine.logError("TestEngine=>getItemFlavor newlog: preload still in progress "+s.getIdentifier());var o=function(){n.getItemFlavor(e,t)};setTimeout(o,1e3)}else window.TestEngine.logError("TestEngine=>getItemFlavor "+e),$(document).trigger("inform.preloadDone"),n.retrieveItemFromServer(e,r)};if(s.isPreloaded()&&!n.backgroundPreloadingInProgress)window.TestEngine.logError("TestEngine=>getItemFlavor newlog: item is preloaded "+s.getIdentifier()),r(void 0);else if(n.backgroundPreloadingInProgress){n._stopBackgroundPreloading=!0;var o=500,a=function(){if(window.TestEngine.logError("TestEngine=>getItemFlavor newlog: trying preload again "+s.getIdentifier()),n.backgroundPreloadingInProgress){setTimeout(a,o)}else window.TestEngine.logError("TestEngine=>getItemFlavor newlog: background preload complete "+s.getIdentifier()),n._itemRequestInQueue=!1,s.isPreloaded()?r(void 0):n.preloadFurther([s],r,!0)};n._itemRequestInQueue=!0,window.TestEngine.logError("TestEngine=>getItemFlavor backgroundPreloadingInProgress "+s.getIdentifier());setTimeout(a,o)}else if(s.isPreloadInProgress()){var o=500,a=function(){if(s.isPreloadInProgress()){setTimeout(a,o)}else n._itemRequestInQueue=!1,r(void 0)};n._itemRequestInQueue=!0;setTimeout(a,o)}else n.preloadFurther([s],r,!0)}else $(document).trigger("inform.preloadDone"),n.retrieveItemFromServer(e,t)}else n._testEng._isAppMode()?n._testEng._native.desktopLockdownStateChanged():n._testEng._native.fullscreenStateChanged(!0)},e.prototype.preload=function(e,t,n,i){var s=window.TestEngine._navigation;if(s._preloadCount>0&&s.backgroundPreloadingInProgress)return void s._preloadCount++;var r=s.getNavigator(s._currentSection).getItemListToPreload();if(r&&(!r||0!==r.length)){s._preloadCount++,s.backgroundPreloadingInProgress=!0;var o=function(){if(s._preloadCount--,s._stopBackgroundPreloading)return s._stopBackgroundPreloading=!1,void(s.backgroundPreloadingInProgress=!1);if(s._preloadCount>0){var e=s.getNavigator(s._currentSection).getItemListToPreload();e.length>0?s.preloadFurther(e,o):o()}else window.TestEngine.logError("TestEngine=>Preload: Background preload complete"),s.backgroundPreloadingInProgress=!1};if(r.length>0){var a=function(){window.TestEngine.logError("TestEngine=>Preload: startingPreload "+r.length+" items"),s.preloadFurther(r,o)};setTimeout(a,1e3)}else o()}},e.prototype.preloadFurther=function(e,t,n,i){for(var s=e.length-1,r=(new Array,window.TestEngine._navigation),o=function(o){var a=function(){for(var t=0;t<e.length;t++)e[t].setPreloaded()},c=function(){for(var t=0;t<e.length;t++)e[t].setPreloadInProgress()},u=function(){for(var t=0;t<e.length;t++)e[t].setPreloadFailed()};c();var l=new Array,d=window.TestEngine._native.getSecureRemoteUrl();d=d.indexOf("/api/8.0")!==-1?d.substring(0,d.indexOf("/api/8.0")):d;for(var g=new Object,p=0;p<o.length;p++){var h=new Array,f=o[p],m=window.TestEngine.getTestDefine().getItemContentVersion(e[s-p].getIdentifier()),v=window.TestEngine.getNavigation().getCurrentTestPart().getSectionByItemId(e[s-p].getIdentifier());if(f.preloadURLs&&f.preloadURLs.length>0&&(h=h.concat(f.preloadURLs)),f.itemDependency&&f.itemDependency.length>0)for(var _=JSON.parse(f.itemDependency),y=0;y<_.length;y++){var T=_[y];if(0!==T.indexOf("http:")&&0!==T.indexOf("https:")){if(T.indexOf(".par")!==-1&&window.TestEngine._native.restrictParFilePreloading())continue;h.push(d+"/client/"+T)}}if(f.itemBodyScriptLibs&&f.itemBodyScriptLibs.length>0)for(var w=JSON.parse(f.itemBodyScriptLibs),S=0;S<w.length;S++){var I=w[S];0!==I.src.indexOf("http:")&&0!==I.src.indexOf("https:")&&h.push(d+"/client/"+I.src)}var E=window.TestEngine.getRegisteredCallback(window.TestEngine.constructor.FILTER_DEPEDENCIES);E&&(h=E(h,v.getIdentifier(),e[s-p],f));for(var C=0;C<h.length;C++)if(g[h[C]]={contentVersion:m},f.checksums){var b=f.checksums[h[C]]?f.checksums[h[C]]:f.checksums[h[C].replace("http://","https://")];g[h[C]].checksum=b}l=l.concat(h)}if(!l||l&&0===l.length)return a(),void(t&&t.call(r,null));var A=new Array,R=new Array;A=r.groupSameResurcesWithDifferentFormat(l,A),R=r.logUnsupportedFormatIndexes(r,window.TN8.SupportMediaForm.getSupportedMediaFormats("audio"),A,R),R=r.logUnsupportedFormatIndexes(r,window.TN8.SupportMediaForm.getSupportedMediaFormats("video"),A,R);var k=0;R.sort(function(e,t){return e-t});for(var N=0;N<R.length;N++)l.splice(R[N]-k,1),k++;for(var F=new Array,x=0;x<l.length;x++)r._preloadUniqueResourceList.indexOf(l[x])!==-1?(l.splice(x,1),x--):(r._preloadUniqueResourceList.push(l[x]),l[x].indexOf(".par")!==-1&&(F.push(l[x]),l.splice(x,1),x--));if(l&&0===l.length&&0===F.length)return a(),void(t&&t.call(r,null));var O=$.proxy(r.preloadResourcesSuccessCallback,r,r,a,i,t),P=$.proxy(r.preloadResourcesErrorCallback,r,r,u,F,l,e,t,n),L=$.proxy(window.TestEngine._serverInterface.preloadResources,window.TestEngine._serverInterface,l,O,P,r,g);window.TestEngine.logError&&window.TestEngine.logError("TestEngine=>preloadFurther: preload array length "+l.length),F.length>0&&l.length>0?window.TestEngine._serverInterface.preloadResources(F,$.proxy(r.preloadParsSuccessCallback,r,r,L),P,r,g):F.length>0&&0===l.length?window.TestEngine._serverInterface.preloadResources(F,O,P,r,g):L()},a=function(t){r.shouldStopPreloading()||(u=new Array,window.TestEngine.ewsError(window.TestEngine,'{"success":"no","errorcode":"1009","msg":"Unable to load item content","details":"Preload Failed for Item Id: '+t+'"}',window.TestEngine._navigation.retriveIndividualItem,[e,o,s,u,a,!0]))},c=0;c<e.length;c++)e[c].setPreloadInProgress();var u=new Array;r.shouldStopPreloading()||r.retriveIndividualItem(e,o,s,u,a)},e.prototype.preloadParsSuccessCallback=function(e,t,n){if(window.TestEngine.logError("TestEngine=>preloadFurther: par preload success: "+!(void 0!==n.success&&("no"===n.success||"No"===n.success||"NO"===n.success))),!e.shouldStopPreloading()){if(void 0!==n.success&&("no"===n.success||"No"===n.success||"NO"===n.success)){var i={msgCode:n.msgCode,msg:n.msg};return void window.TestEngine.emitEvent(new window.TestEngine.EventLib.Event(window.TestEngine.constructor.FATAL_ENGINE_ERROR,i))}t()}},e.prototype.preloadResourcesSuccessCallback=function(e,t,n,i,s){if(window.TestEngine.logError("TestEngine=>preloadFurther: preload success: "+!(void 0!==s.success&&("no"===s.success||"No"===s.success||"NO"===s.success))),!e.shouldStopPreloading()){if(void 0!==s.success&&("no"===s.success||"No"===s.success||"NO"===s.success)){var r={msgCode:s.msgCode,msg:s.msg};return void window.TestEngine.emitEvent(new window.TestEngine.EventLib.Event(window.TestEngine.constructor.FATAL_ENGINE_ERROR,r))}t(),n&&window.TestEngine._ewsRetrySucessfullCallback.call(e),i&&i.call(e,null)}},e.prototype.preloadResourcesErrorCallback=function(e,t,n,i,s,r,o,a){window.TestEngine.logError("TestEngine=>preloadFurther newlog: preload error "+JSON.stringify(a)),t();for(var c=0;c<e._preloadUniqueResourceList.length;c++)i.indexOf(e._preloadUniqueResourceList[c])===-1&&n.indexOf(e._preloadUniqueResourceList[c])===-1||(e._preloadUniqueResourceList.splice(c,1),c--);for(var u=new Array,l=0;l<s.length;l++)u.push(s[l].getIdentifier());u.join(","),e.shouldStopPreloading()||window.TestEngine.ewsError(window.TestEngine,'{"success":"no","errorcode":"1009","msg":"Unable to load item content","details":"Preload Failed while downloading assets of Item ids: '+u+'"}',e.preloadFurther,[s,r,o,!0])},e.prototype.groupSameResurcesWithDifferentFormat=function(e,t){for(var n={},i=0;i<e.length;i++){var s=e[i],r=s.substring(0,s.lastIndexOf("."));if(!n[r]){var o=new Array,a={index:i,val:s};o.push(a);for(var c=i+1;c<e.length;c++){var u=e[c],l=u.substring(0,u.lastIndexOf("."));if(r===l){var d={index:c,val:u};o.push(d),n[r]=!0}}o.length>1&&t.push(o)}}return t},e.prototype.getUnsupportedFormatIndexes=function(e,t){for(var n=!1,i=new Array,s=0;s<t.length;s++)for(var r=t[s],o=0;o<e.length;o++){var a=e[o];if(!n&&a.val.indexOf(r)!==-1){n=!0;break}n&&a.val.indexOf(t[s])!==-1&&i.push(a.index)}return i},e.prototype.logUnsupportedFormatIndexes=function(e,t,n,i){for(var s=0;s<n.length;s++){var r=n[s],o=e.getUnsupportedFormatIndexes(r,t);o.length>0&&(i=i.concat(o))}return i},e.prototype.retriveIndividualItem=function(e,t,n,i,s,r){var o=window.TestEngine._navigation;if(n<0){if(r)try{window.TestEngine._ewsRetrySucessfullCallback.call(o)}catch(e){}return void t.call(this,i)}var a=function(e){var t=window.TestEngine.getDesiredFlavor(e),n=o._apiBaseUrl+"/item/"+e+"/flavor/"+t;return n},c=function(a){if(!o.shouldStopPreloading()){if(!a)return void s.call(this,e[n].getIdentifier());if(void 0!==a.success&&("no"===a.success||"No"===a.success||"NO"===a.success)){var c={msgCode:a.msgCode,msg:a.msg};return void window.TestEngine.emitEvent(new window.TestEngine.EventLib.Event(window.TestEngine.constructor.FATAL_ENGINE_ERROR,c))}i.push(a),o.retriveIndividualItem(e,t,--n,i,s,r)}},u=function(t){var i=function(t,i,r){for(var o=0;o<e.length;o++)e[o].setPreloadFailed();s.call(this,e[n].getIdentifier())};window.TestEngine.logError("TestEngine=>getItemFlavor for preload "+e[n].getIdentifier()),window.TestEngine._serverInterface.getItemFlavor(e[n].getIdentifier(),c,i,window)};u(a(e[n].getIdentifier()))},e.prototype.gotoSection=function(e){this._currentSection=e,this.navigateItem(e.getFirstItem())},e.prototype.nextSection=function(){var e=this._currentSection.getNextSibling();return this.navigateSection(e),this._currentSection},e.prototype.previousSection=function(){var e=this._currentSection.getPreviousSibling();return this.navigateSection(e),this._currentSection},e.prototype.gotoTestPart=function(e){this._currentTestPart=e,this.navigateSection(e.getFirstSection())},e.prototype.showTestOverview=function(t){this.emitEvent(new window.TestEngine.EventLib.Event(e.SHOW_TEST_OVERVIEW,t))},e.prototype.showSectionOverview=function(t){this.emitEvent(new window.TestEngine.EventLib.Event(e.SHOW_SECTION_OVERVIEW,t))},e.prototype.showEWS=function(){},e.prototype.setFirstItemCallback=function(e,t,n,i){var s=window.TestEngine._navigation;if(e.isLinear()||!s.backgroundPreloadingInProgress)s.getNavigator(e).setFirstItemCallback(e,t,n,i);else{setTimeout(function(){s.setFirstItemCallback(e,t,n,i)},300)}},e.prototype.setNextItemIdCallback=function(e,t){var n=window.TestEngine._navigation;n.getNavigator(n._currentSection).setNextItemIdCallback(e,t)},e.prototype.setPrevItemIdCallback=function(e,t){var n=window.TestEngine._navigation;n.getNavigator(n._currentSection).setPrevItemIdCallback(e,t);
},e.prototype.setItemIdCallback=function(e,t,n){var i=window.TestEngine._navigation;i.getNavigator(i._currentSection).setItemIdCallback(e,t,n)},e.prototype.setResumedItemIdCallback=function(e,t,n,i){var s=window.TestEngine._navigation;s.getNavigator(e).setResumedItemIdCallback(e,t,n,i)},e.prototype.setLastItemIdCallback=function(e,t){var n=window.TestEngine._navigation;n.getNavigator(n._currentSection).setLastItemIdCallback(e,t)},e.prototype.scoreItem=function(e,t,n,i){var s=window.TestEngine._navigation;s.getNavigator(s._currentSection).scoreItem(e,t,n,i)},e.prototype.getCorrectTestCases=function(e,t){var n=window.TestEngine._navigation;n.getNavigator(n._currentSection).getCorrectTestCases(e,t)},e.prototype.scoreFeedback=function(e,t,n){var i=window.TestEngine._navigation;i.getNavigator(i._currentSection).scoreFeedback(e,t,n)},e.prototype.getNavigator=function(e){var t=window.TestEngine._navigation,n=e.getIdentifier();return t._navigatorHolder[n]||(e.isLinear()?t._navigatorHolder[n]=new s.SequentialNavigator(e):t._navigatorHolder[n]=new r.AdaptiveNavigator(e)),t._navigatorHolder[n]},e.prototype.setAssetsReadyCallback=function(e){this._assetsReadyCallback=e},e.prototype.getCurrentTestPart=function(){return this._currentTestPart},e.prototype.getCurrentSection=function(){return this._currentSection},e.prototype.getCurrentItem=function(){return this._currentItem},e.prototype.getTestId=function(){return this._testInformation.getTestId()},e.prototype.stopPreloading=function(){var e=window.TestEngine._navigation;e._preloadCount=0,e._stopPreloading=!0},e.prototype.shouldStopPreloading=function(){var e=window.TestEngine._navigation;return!!(e&&e._stopPreloading||!window.TestEngine.getTestDefine())},e.prototype.cleanUp=function(){var e=window.TestEngine._navigation;e._preloadUniqueResourceList=new Array,e._isResumedTest=!1,e._stopPreloading=!1,e._isItemRequestInProcess=!1},e}();e.Navigation=t}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("StateData",["require","exports"],function(e,t){!function(e){var t=function(){function e(){this._formId="",this._testId="",this._studentId="",this._timestamp=(new Date).getTime(),this._data={}}return e.prototype.initializeFromObj=function(e){"formId"in e&&(this._formId=e.formId),"testId"in e&&(this._testId=e.testId),"studentId"in e&&(this._studentId=e.studentId),"data"in e&&(this._data=e.data)},e.prototype.initialize=function(e,t,n){for(var i=[],s=0;s<arguments.length-3;s++)i[s]=arguments[s+3];this._testId=e,this._studentId=t,this._data=n},e.prototype.toJSON=function(){var e={formId:this._formId,testId:this._testId,studentId:this._studentId,timestamp:this._timestamp,data:this._data};return e},e.prototype.getFormId=function(){return this._formId},e.prototype.getTestId=function(){return this._testId},e.prototype.getStudentId=function(){return this._studentId},e.prototype.getTimeStamp=function(){return this._timestamp},e.prototype.getData=function(){return this._data},e}();e.StateData=t;var n=function(e){function t(){e.call(this)}return __extends(t,e),t}(t);e.TestStateData=n;var i=function(e){function t(){e.call(this),this._itemId=""}return __extends(t,e),t.prototype.initializeFromObj=function(t){e.prototype.initializeFromObj.call(this,t),"itemId"in t&&(this._itemId=t.itemId)},t.prototype.initialize=function(t,n,i,s,r,o){e.prototype.initialize.call(this,t,n,s),this._itemId=i,this._version=r,this._order=o},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.itemId=this._itemId,t.version=this._version,t.itemOrder=this._order,t},t.prototype.getItemId=function(){return this._itemId},t.prototype.getVersion=function(){return this._version},t.prototype.getItemOrder=function(){return this._order},t}(t);e.ItemStateData=i}(t.TestEngine||(t.TestEngine={}))}),function(){"use strict";function e(e){throw e}function t(e,t){var n=e.split("."),i=S;!(n[0]in i)&&i.execScript&&i.execScript("var "+n[0]);for(var s;n.length&&(s=n.shift());)n.length||t===T?i=i[s]?i[s]:i[s]={}:i[s]=t}function n(t,n){this.index="number"==typeof n?n:0,this.i=0,this.buffer=t instanceof(I?Uint8Array:Array)?t:new(I?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&e(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function i(e){this.buffer=new(I?Uint16Array:Array)(2*e),this.length=0}function s(e){var t,n,i,s,r,o,a,c,u,l,d=e.length,g=0,p=Number.POSITIVE_INFINITY;for(c=0;c<d;++c)e[c]>g&&(g=e[c]),e[c]<p&&(p=e[c]);for(t=1<<g,n=new(I?Uint32Array:Array)(t),i=1,s=0,r=2;i<=g;){for(c=0;c<d;++c)if(e[c]===i){for(o=0,a=s,u=0;u<i;++u)o=o<<1|1&a,a>>=1;for(l=i<<16|c,u=o;u<t;u+=r)n[u]=l;++s}++i,s<<=1,r<<=1}return[n,g,p]}function r(e,t){this.h=F,this.w=0,this.input=I&&e instanceof Array?new Uint8Array(e):e,this.b=0,t&&(t.lazy&&(this.w=t.lazy),"number"==typeof t.compressionType&&(this.h=t.compressionType),t.outputBuffer&&(this.a=I&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.b=t.outputIndex)),this.a||(this.a=new(I?Uint8Array:Array)(32768))}function o(e,t){this.length=e,this.H=t}function a(t,n){function i(t,n){var i,s=t.H,r=[],o=0;i=L[t.length],r[o++]=65535&i,r[o++]=i>>16&255,r[o++]=i>>24;var a;switch(w){case 1===s:a=[0,s-1,0];break;case 2===s:a=[1,s-2,0];break;case 3===s:a=[2,s-3,0];break;case 4===s:a=[3,s-4,0];break;case 6>=s:a=[4,s-5,1];break;case 8>=s:a=[5,s-7,1];break;case 12>=s:a=[6,s-9,2];break;case 16>=s:a=[7,s-13,2];break;case 24>=s:a=[8,s-17,3];break;case 32>=s:a=[9,s-25,3];break;case 48>=s:a=[10,s-33,4];break;case 64>=s:a=[11,s-49,4];break;case 96>=s:a=[12,s-65,5];break;case 128>=s:a=[13,s-97,5];break;case 192>=s:a=[14,s-129,6];break;case 256>=s:a=[15,s-193,6];break;case 384>=s:a=[16,s-257,7];break;case 512>=s:a=[17,s-385,7];break;case 768>=s:a=[18,s-513,8];break;case 1024>=s:a=[19,s-769,8];break;case 1536>=s:a=[20,s-1025,9];break;case 2048>=s:a=[21,s-1537,9];break;case 3072>=s:a=[22,s-2049,10];break;case 4096>=s:a=[23,s-3073,10];break;case 6144>=s:a=[24,s-4097,11];break;case 8192>=s:a=[25,s-6145,11];break;case 12288>=s:a=[26,s-8193,12];break;case 16384>=s:a=[27,s-12289,12];break;case 24576>=s:a=[28,s-16385,13];break;case 32768>=s:a=[29,s-24577,13];break;default:e("invalid distance")}i=a,r[o++]=i[0],r[o++]=i[1],r[o++]=i[2];var c,u;for(c=0,u=r.length;c<u;++c)f[m++]=r[c];_[r[0]]++,y[r[3]]++,v=t.length+n-1,g=null}var s,r,o,a,u,l,d,g,p,h={},f=I?new Uint16Array(2*n.length):[],m=0,v=0,_=new(I?Uint32Array:Array)(286),y=new(I?Uint32Array:Array)(30),S=t.w;if(!I){for(o=0;285>=o;)_[o++]=0;for(o=0;29>=o;)y[o++]=0}for(_[256]=1,s=0,r=n.length;s<r;++s){for(o=u=0,a=3;o<a&&s+o!==r;++o)u=u<<8|n[s+o];if(h[u]===T&&(h[u]=[]),l=h[u],!(0<v--)){for(;0<l.length&&32768<s-l[0];)l.shift();if(s+3>=r){for(g&&i(g,-1),o=0,a=r-s;o<a;++o)p=n[s+o],f[m++]=p,++_[p];break}0<l.length?(d=c(n,s,l),g?g.length<d.length?(p=n[s-1],f[m++]=p,++_[p],i(d,0)):i(g,-1):d.length<S?g=d:i(d,0)):g?i(g,-1):(p=n[s],f[m++]=p,++_[p])}l.push(s)}return f[m++]=256,_[256]++,t.M=_,t.L=y,I?f.subarray(0,m):f}function c(e,t,n){var i,s,r,a,c,u,l=0,d=e.length;a=0,u=n.length;e:for(;a<u;a++){if(i=n[u-a-1],r=3,3<l){for(c=l;3<c;c--)if(e[i+c-1]!==e[t+c-1])continue e;r=l}for(;258>r&&t+r<d&&e[i+r]===e[t+r];)++r;if(r>l&&(s=i,l=r),258===r)break}return new o(l,t-s)}function u(e,t){var n,s,r,o,a,c=e.length,u=new i(572),d=new(I?Uint8Array:Array)(c);if(!I)for(o=0;o<c;o++)d[o]=0;for(o=0;o<c;++o)0<e[o]&&u.push(o,e[o]);if(n=Array(u.length/2),s=new(I?Uint32Array:Array)(u.length/2),1===n.length)return d[u.pop().index]=1,d;for(o=0,a=u.length/2;o<a;++o)n[o]=u.pop(),s[o]=n[o].value;for(r=l(s,s.length,t),o=0,a=n.length;o<a;++o)d[n[o].index]=r[o];return d}function l(e,t,n){function i(e){var n=p[e][h[e]];n===t?(i(e+1),i(e+1)):--d[n],++h[e]}var s,r,o,a,c,u=new(I?Uint16Array:Array)(n),l=new(I?Uint8Array:Array)(n),d=new(I?Uint8Array:Array)(t),g=Array(n),p=Array(n),h=Array(n),f=(1<<n)-t,m=1<<n-1;for(u[n-1]=t,r=0;r<n;++r)f<m?l[r]=0:(l[r]=1,f-=m),f<<=1,u[n-2-r]=(u[n-1-r]/2|0)+t;for(u[0]=l[0],g[0]=Array(u[0]),p[0]=Array(u[0]),r=1;r<n;++r)u[r]>2*u[r-1]+l[r]&&(u[r]=2*u[r-1]+l[r]),g[r]=Array(u[r]),p[r]=Array(u[r]);for(s=0;s<t;++s)d[s]=n;for(o=0;o<u[n-1];++o)g[n-1][o]=e[o],p[n-1][o]=o;for(s=0;s<n;++s)h[s]=0;for(1===l[n-1]&&(--d[0],++h[n-1]),r=n-2;0<=r;--r){for(a=s=0,c=h[r+1],o=0;o<u[r];o++)a=g[r+1][c]+g[r+1][c+1],a>e[s]?(g[r][o]=a,p[r][o]=t,c+=2):(g[r][o]=e[s],p[r][o]=s,++s);h[r]=0,1===l[r]&&i(r)}return d}function d(e){var t,n,i,s,r=new(I?Uint16Array:Array)(e.length),o=[],a=[],c=0;for(t=0,n=e.length;t<n;t++)o[e[t]]=(0|o[e[t]])+1;for(t=1,n=16;t<=n;t++)a[t]=c,c+=0|o[t],c<<=1;for(t=0,n=e.length;t<n;t++)for(c=a[e[t]],a[e[t]]+=1,i=r[t]=0,s=e[t];i<s;i++)r[t]=r[t]<<1|1&c,c>>>=1;return r}function g(t,n){switch(this.l=[],this.m=32768,this.e=this.g=this.c=this.q=0,this.input=I?new Uint8Array(t):t,this.s=!1,this.n=D,this.C=!1,!n&&(n={})||(n.index&&(this.c=n.index),n.bufferSize&&(this.m=n.bufferSize),n.bufferType&&(this.n=n.bufferType),n.resize&&(this.C=n.resize)),this.n){case U:this.b=32768,this.a=new(I?Uint8Array:Array)(32768+this.m+258);break;case D:this.b=0,this.a=new(I?Uint8Array:Array)(this.m),this.f=this.K,this.t=this.I,this.o=this.J;break;default:e(Error("invalid inflate mode"))}}function p(t,n){for(var i,s=t.g,r=t.e,o=t.input,a=t.c,c=o.length;r<n;)a>=c&&e(Error("input buffer is broken")),s|=o[a++]<<r,r+=8;return i=s&(1<<n)-1,t.g=s>>>n,t.e=r-n,t.c=a,i}function h(e,t){for(var n,i,s=e.g,r=e.e,o=e.input,a=e.c,c=o.length,u=t[0],l=t[1];r<l&&!(a>=c);)s|=o[a++]<<r,r+=8;return n=u[s&(1<<l)-1],i=n>>>16,e.g=s>>i,e.e=r-i,e.c=a,65535&n}function f(e){function t(e,t,n){var i,s,r,o=this.z;for(r=0;r<e;)switch(i=h(this,t)){case 16:for(s=3+p(this,2);s--;)n[r++]=o;break;case 17:for(s=3+p(this,3);s--;)n[r++]=0;o=0;break;case 18:for(s=11+p(this,7);s--;)n[r++]=0;o=0;break;default:o=n[r++]=i}return this.z=o,n}var n,i,r,o,a=p(e,5)+257,c=p(e,5)+1,u=p(e,4)+4,l=new(I?Uint8Array:Array)(H.length);for(o=0;o<u;++o)l[H[o]]=p(e,3);if(!I)for(o=u,u=l.length;o<u;++o)l[H[o]]=0;n=s(l),i=new(I?Uint8Array:Array)(a),r=new(I?Uint8Array:Array)(c),e.z=0,e.o(s(t.call(e,a,n,i)),s(t.call(e,c,n,r)))}function m(e){if("string"==typeof e){var t,n,i=e.split("");for(t=0,n=i.length;t<n;t++)i[t]=(255&i[t].charCodeAt(0))>>>0;e=i}for(var s,r=1,o=0,a=e.length,c=0;0<a;){s=1024<a?1024:a,a-=s;do r+=e[c++],o+=r;while(--s);r%=65521,o%=65521}return(o<<16|r)>>>0}function v(t,n){var i,s;switch(this.input=t,this.c=0,!n&&(n={})||(n.index&&(this.c=n.index),n.verify&&(this.N=n.verify)),i=t[this.c++],s=t[this.c++],15&i){case ie:this.method=ie;break;default:e(Error("unsupported compression method"))}0!==((i<<8)+s)%31&&e(Error("invalid fcheck flag:"+((i<<8)+s)%31)),32&s&&e(Error("fdict flag is not supported")),this.B=new g(t,{index:this.c,bufferSize:n.bufferSize,bufferType:n.bufferType,resize:n.resize})}function _(e,t){this.input=e,this.a=new(I?Uint8Array:Array)(32768),this.h=se.k;var n,i={};!t&&(t={})||"number"!=typeof t.compressionType||(this.h=t.compressionType);for(n in t)i[n]=t[n];i.outputBuffer=this.a,this.A=new r(this.input,i)}function y(e,n){var i,s,r,o;if(Object.keys)i=Object.keys(n);else for(s in i=[],r=0,n)i[r++]=s;for(r=0,o=i.length;r<o;++r)s=i[r],t(e+"."+s,n[s])}var T=void 0,w=!0,S=this,I="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;n.prototype.f=function(){var e,t=this.buffer,n=t.length,i=new(I?Uint8Array:Array)(n<<1);if(I)i.set(t);else for(e=0;e<n;++e)i[e]=t[e];return this.buffer=i},n.prototype.d=function(e,t,n){var i,s=this.buffer,r=this.index,o=this.i,a=s[r];if(n&&1<t&&(e=8<t?(k[255&e]<<24|k[e>>>8&255]<<16|k[e>>>16&255]<<8|k[e>>>24&255])>>32-t:k[e]>>8-t),8>t+o)a=a<<t|e,o+=t;else for(i=0;i<t;++i)a=a<<1|e>>t-i-1&1,8===++o&&(o=0,s[r++]=k[a],a=0,r===s.length&&(s=this.f()));s[r]=a,this.buffer=s,this.i=o,this.index=r},n.prototype.finish=function(){var e,t=this.buffer,n=this.index;return 0<this.i&&(t[n]<<=8-this.i,t[n]=k[t[n]],n++),I?e=t.subarray(0,n):(t.length=n,e=t),e};var E,C=new(I?Uint8Array:Array)(256);for(E=0;256>E;++E){for(var b=E,A=b,R=7,b=b>>>1;b;b>>>=1)A<<=1,A|=1&b,--R;C[E]=(A<<R&255)>>>0}var k=C;i.prototype.getParent=function(e){return 2*((e-2)/4|0)},i.prototype.push=function(e,t){var n,i,s,r=this.buffer;for(n=this.length,r[this.length++]=t,r[this.length++]=e;0<n&&(i=this.getParent(n),r[n]>r[i]);)s=r[n],r[n]=r[i],r[i]=s,s=r[n+1],r[n+1]=r[i+1],r[i+1]=s,n=i;return this.length},i.prototype.pop=function(){var e,t,n,i,s,r=this.buffer;for(t=r[0],e=r[1],this.length-=2,r[0]=r[this.length],r[1]=r[this.length+1],s=0;(i=2*s+2,!(i>=this.length))&&(i+2<this.length&&r[i+2]>r[i]&&(i+=2),r[i]>r[s]);)n=r[s],r[s]=r[i],r[i]=n,n=r[s+1],r[s+1]=r[i+1],r[i+1]=n,s=i;return{index:e,value:t,length:this.length}};var N,F=2,x={NONE:0,r:1,k:F,O:3},O=[];for(N=0;288>N;N++)switch(w){case 143>=N:O.push([N+48,8]);break;case 255>=N:O.push([N-144+400,9]);break;case 279>=N:O.push([N-256+0,7]);break;case 287>=N:O.push([N-280+192,8]);break;default:e("invalid literal: "+N)}r.prototype.j=function(){var t,i,s,r,o=this.input;switch(this.h){case 0:for(s=0,r=o.length;s<r;){i=I?o.subarray(s,s+65535):o.slice(s,s+65535),s+=i.length;var c=i,l=s===r,g=T,p=T,h=T,f=T,m=T,v=this.a,_=this.b;if(I){for(v=new Uint8Array(this.a.buffer);v.length<=_+c.length+5;)v=new Uint8Array(v.length<<1);v.set(this.a)}if(g=l?1:0,v[_++]=0|g,p=c.length,h=~p+65536&65535,v[_++]=255&p,v[_++]=p>>>8&255,v[_++]=255&h,v[_++]=h>>>8&255,I)v.set(c,_),_+=c.length,v=v.subarray(0,_);else{for(f=0,m=c.length;f<m;++f)v[_++]=c[f];v.length=_}this.b=_,this.a=v}break;case 1:var y=new n(I?new Uint8Array(this.a.buffer):this.a,this.b);y.d(1,1,w),y.d(1,2,w);var S,E,C,b=a(this,o);for(S=0,E=b.length;S<E;S++)if(C=b[S],n.prototype.d.apply(y,O[C]),256<C)y.d(b[++S],b[++S],w),y.d(b[++S],5),y.d(b[++S],b[++S],w);else if(256===C)break;this.a=y.finish(),this.b=this.a.length;break;case F:var A,R,k,N,x,P,L,U,D,M,B,V,J,H,$,q=new n(I?new Uint8Array(this.a.buffer):this.a,this.b),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=Array(19);for(A=F,q.d(1,1,w),q.d(A,2,w),R=a(this,o),P=u(this.M,15),L=d(P),U=u(this.L,7),D=d(U),k=286;257<k&&0===P[k-1];k--);for(N=30;1<N&&0===U[N-1];N--);var z,W,K,G,X,Z,Y=k,ee=N,te=new(I?Uint32Array:Array)(Y+ee),ne=new(I?Uint32Array:Array)(316),ie=new(I?Uint8Array:Array)(19);for(z=W=0;z<Y;z++)te[W++]=P[z];for(z=0;z<ee;z++)te[W++]=U[z];if(!I)for(z=0,G=ie.length;z<G;++z)ie[z]=0;for(z=X=0,G=te.length;z<G;z+=W){for(W=1;z+W<G&&te[z+W]===te[z];++W);if(K=W,0===te[z])if(3>K)for(;0<K--;)ne[X++]=0,ie[0]++;else for(;0<K;)Z=138>K?K:138,Z>K-3&&Z<K&&(Z=K-3),10>=Z?(ne[X++]=17,ne[X++]=Z-3,ie[17]++):(ne[X++]=18,ne[X++]=Z-11,ie[18]++),K-=Z;else if(ne[X++]=te[z],ie[te[z]]++,K--,3>K)for(;0<K--;)ne[X++]=te[z],ie[te[z]]++;else for(;0<K;)Z=6>K?K:6,Z>K-3&&Z<K&&(Z=K-3),ne[X++]=16,ne[X++]=Z-3,ie[16]++,K-=Z}for(t=I?ne.subarray(0,X):ne.slice(0,X),M=u(ie,7),H=0;19>H;H++)Q[H]=M[j[H]];for(x=19;4<x&&0===Q[x-1];x--);for(B=d(M),q.d(k-257,5,w),q.d(N-1,5,w),q.d(x-4,4,w),H=0;H<x;H++)q.d(Q[H],3,w);for(H=0,$=t.length;H<$;H++)if(V=t[H],q.d(B[V],M[V],w),16<=V){switch(H++,V){case 16:J=2;break;case 17:J=3;break;case 18:J=7;break;default:e("invalid code: "+V)}q.d(t[H],J,w)}var se,re,oe,ae,ce,ue,le,de,ge=[L,P],pe=[D,U];for(ce=ge[0],ue=ge[1],le=pe[0],de=pe[1],se=0,re=R.length;se<re;++se)if(oe=R[se],q.d(ce[oe],ue[oe],w),256<oe)q.d(R[++se],R[++se],w),ae=R[++se],q.d(le[ae],de[ae],w),q.d(R[++se],R[++se],w);else if(256===oe)break;this.a=q.finish(),this.b=this.a.length;break;default:e("invalid compression type")}return this.a};var P=function(){function t(t){switch(w){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:e("invalid length: "+t)}}var n,i,s=[];for(n=3;258>=n;n++)i=t(n),s[n]=i[2]<<24|i[1]<<16|i[0];return s}(),L=I?new Uint32Array(P):P,U=0,D=1,M={F:U,D:D};g.prototype.p=function(){for(;!this.s;){var t=p(this,3);switch(1&t&&(this.s=w),t>>>=1){case 0:var n=this.input,i=this.c,s=this.a,r=this.b,o=n.length,a=T,c=T,u=s.length,l=T;switch(this.e=this.g=0,i+1>=o&&e(Error("invalid uncompressed block header: LEN")),a=n[i++]|n[i++]<<8,i+1>=o&&e(Error("invalid uncompressed block header: NLEN")),c=n[i++]|n[i++]<<8,a===~c&&e(Error("invalid uncompressed block header: length verify")),i+a>n.length&&e(Error("input buffer is broken")),this.n){case U:for(;r+a>s.length;){if(l=u-r,a-=l,I)s.set(n.subarray(i,i+l),r),r+=l,i+=l;else for(;l--;)s[r++]=n[i++];this.b=r,s=this.f(),r=this.b}break;case D:for(;r+a>s.length;)s=this.f({v:2});break;default:e(Error("invalid inflate mode"))}if(I)s.set(n.subarray(i,i+a),r),r+=a,i+=a;else for(;a--;)s[r++]=n[i++];this.c=i,this.b=r,this.a=s;break;case 1:this.o(ee,ne);break;case 2:f(this);break;default:e(Error("unknown BTYPE: "+t))}}return this.t()};var B,V,J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=I?new Uint16Array(J):J,$=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],q=I?new Uint16Array($):$,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],Q=I?new Uint8Array(j):j,z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],W=I?new Uint16Array(z):z,K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],G=I?new Uint8Array(K):K,X=new(I?Uint8Array:Array)(288);for(B=0,V=X.length;B<V;++B)X[B]=143>=B?8:255>=B?9:279>=B?7:8;var Z,Y,ee=s(X),te=new(I?Uint8Array:Array)(30);for(Z=0,Y=te.length;Z<Y;++Z)te[Z]=5;var ne=s(te);g.prototype.o=function(e,t){var n=this.a,i=this.b;this.u=e;for(var s,r,o,a,c=n.length-258;256!==(s=h(this,e));)if(256>s)i>=c&&(this.b=i,n=this.f(),i=this.b),n[i++]=s;else for(r=s-257,a=q[r],0<Q[r]&&(a+=p(this,Q[r])),s=h(this,t),o=W[s],0<G[s]&&(o+=p(this,G[s])),i>=c&&(this.b=i,n=this.f(),i=this.b);a--;)n[i]=n[i++-o];for(;8<=this.e;)this.e-=8,this.c--;this.b=i},g.prototype.J=function(e,t){var n=this.a,i=this.b;this.u=e;for(var s,r,o,a,c=n.length;256!==(s=h(this,e));)if(256>s)i>=c&&(n=this.f(),c=n.length),n[i++]=s;else for(r=s-257,a=q[r],0<Q[r]&&(a+=p(this,Q[r])),s=h(this,t),o=W[s],0<G[s]&&(o+=p(this,G[s])),i+a>c&&(n=this.f(),c=n.length);a--;)n[i]=n[i++-o];for(;8<=this.e;)this.e-=8,this.c--;this.b=i},g.prototype.f=function(){var e,t,n=new(I?Uint8Array:Array)(this.b-32768),i=this.b-32768,s=this.a;if(I)n.set(s.subarray(32768,n.length));else for(e=0,t=n.length;e<t;++e)n[e]=s[e+32768];if(this.l.push(n),this.q+=n.length,I)s.set(s.subarray(i,i+32768));else for(e=0;32768>e;++e)s[e]=s[i+e];return this.b=32768,s},g.prototype.K=function(e){var t,n,i,s,r=this.input.length/this.c+1|0,o=this.input,a=this.a;return e&&("number"==typeof e.v&&(r=e.v),"number"==typeof e.G&&(r+=e.G)),2>r?(n=(o.length-this.c)/this.u[2],s=258*(n/2)|0,i=s<a.length?a.length+s:a.length<<1):i=a.length*r,I?(t=new Uint8Array(i),t.set(a)):t=a,this.a=t},g.prototype.t=function(){var e,t,n,i,s,r=0,o=this.a,a=this.l,c=new(I?Uint8Array:Array)(this.q+(this.b-32768));if(0===a.length)return I?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(t=0,n=a.length;t<n;++t)for(e=a[t],i=0,s=e.length;i<s;++i)c[r++]=e[i];for(t=32768,n=this.b;t<n;++t)c[r++]=o[t];return this.l=[],this.buffer=c},g.prototype.I=function(){var e,t=this.b;return I?this.C?(e=new Uint8Array(t),e.set(this.a.subarray(0,t))):e=this.a.subarray(0,t):(this.a.length>t&&(this.a.length=t),e=this.a),this.buffer=e},v.prototype.p=function(){var t,n,i=this.input;return t=this.B.p(),this.c=this.B.c,this.N&&(n=(i[this.c++]<<24|i[this.c++]<<16|i[this.c++]<<8|i[this.c++])>>>0,n!==m(t)&&e(Error("invalid adler-32 checksum"))),t};var ie=8,se=x;_.prototype.j=function(){var t,n,i,s,r,o,a,c=0;switch(a=this.a,t=ie){case ie:n=Math.LOG2E*Math.log(32768)-8;break;default:e(Error("invalid compression method"))}switch(i=n<<4|t,a[c++]=i,t){case ie:switch(this.h){case se.NONE:r=0;break;case se.r:r=1;break;case se.k:r=2;break;default:e(Error("unsupported compression type"))}break;default:e(Error("invalid compression method"))}return s=r<<6|0,a[c++]=s|31-(256*i+s)%31,o=m(this.input),this.A.b=c,a=this.A.j(),c=a.length,I&&(a=new Uint8Array(a.buffer),a.length<=c+4&&(this.a=new Uint8Array(a.length+4),this.a.set(a),a=this.a),a=a.subarray(0,c+4)),a[c++]=o>>24&255,a[c++]=o>>16&255,a[c++]=o>>8&255,a[c++]=255&o,a},t("Zlib.Inflate",v),t("Zlib.Inflate.prototype.decompress",v.prototype.p),y("Zlib.Inflate.BufferType",{ADAPTIVE:M.D,BLOCK:M.F}),t("Zlib.Deflate",_),t("Zlib.Deflate.compress",function(e,t){return new _(e,t).j()}),t("Zlib.Deflate.prototype.compress",_.prototype.j),y("Zlib.Deflate.CompressionType",{NONE:se.NONE,FIXED:se.r,DYNAMIC:se.k})}.call(this),define("zlib",function(){}),define("State",["require","exports","./StateData","./zlib"],function(e,t,n,i){var s=n;!function(e){var t=function(){function e(e,t,n){this._devMode=!1,this._localItemCache=new Array,this._devMode=n,this._auth=e,this._apiBaseUrl=t,this._tempStorage=new i,this._practiceTestMode=!1,this._setStateRetries=0,this._lastSavedTestState=null,this._ewsFailureState=!1,this._isFinalSave=!1,this._ewsStatePostFailureCallback,this._localItemCache.bundleArr=[],this._localItemCache.readyToSendBundle=!1,this._lastResponse,this._testStateVersion=0,this._localItemCache.clearBundle=function(){this.bundleArr.length=0}}return e.ITEM="item",e.TEST="test",e.TOOL="tool",e.BUNDLE="itemBundle",e.prototype.deepCopyState=function(e){var t;if(e instanceof Object){var n=JSON.stringify(e);t=JSON.parse(n)}else t=e;return t},e.prototype.getEndpoint=function(t,n){if(void 0===t)return null;var i="",s="itemstates";switch(n){case e.TEST:i+="/test/"+this._auth.getFormId()+"/state/"+this._auth.getLoginId();break;case e.ITEM:i+="/item/"+this._auth.getFormId()+"/"+t.getItemId()+"/"+s+"/"+this._auth.getLoginId();break;case e.BUNDLE:i+="/item/"+this._auth.getFormId()+"/"+s+"/"+this._auth.getLoginId();break;default:console.warn("TestEngine._state.getEndpoint type error")}return i},e.prototype.retrieveFromServer=function(t,n,i,s,r,o){if(void 0===t)return null;var a=void 0!==r?r:this,c="";c=i===e.ITEM?t.getItemId():t.getTestId();var u=this._tempStorage.getMessage(c);if(this._devMode){if(u)var u={state:{data:u}};s.call(a,u)}else{if(!l)var l=function(e){console.log(e)};var d=this.generateAjaxPostRetrieveSettings(n,s,o);window.TestEngine._serverInterface.getAllStates(n,d.data,d.success,d.error)}},e.prototype.generateAjaxPostSettings=function(t,n,i,s,r,o){var a=window.TestEngine._state,c={},u=function(e){var t={};return e&&"[object Function]"===t.toString.call(e)};return c.data=a.shrinkRequestJSON(t,n),n!==e.ITEM?c.success=function(e){i.call(a,e)}:c.success=function(e){e||(e={success:"no"}),e.success&&"yes"===e.success.toLowerCase()?(e.currentServerTime&&window.TestEngine.updateServerTimeOffset(e.currentServerTime),a._localItemCache.readyToSendBundle=!1,a._localItemCache.clearBundle(),i&&i.call(a,e)):(void 0===e.success||e.success&&"no"===e.success.toLowerCase())&&(a.isTestSecure()&&"9053"!==e.msgCode&&"9055"!==e.msgCode&&(window.TestEngine.logError("Error saving responses : "+JSON.stringify(e)),e={success:"no",msg:"State saved to local cache for future transmission."}),s?s.call(a,e):u(i)?i.call(a,e):console.warn("State.prototype.generateAjaxPostSettings -- Passed callback is not a function!"))},c.error=function(t){var s=function(){return!(n!==e.ITEM&&n!==e.TEST||window.TestEngine.storeResponsesFailed||o)},r="Sending responses to server failed";s()&&a.isTestSecure()?(r="State saved to local cache for future transmission.",i.call(a,{success:"no",msg:r})):i.call(a,{success:"no",msg:r})},c},e.prototype.shrinkRequestJSON=function(t,n){var i;return t.timestamp||(t.timestamp=(new Date).getTime()),i="item"===n||n===e.BUNDLE?JSON.stringify({test_state:t.data.test_state,states:t.data.state,ts:t.timestamp,u_sess:this._auth.getLoginToken(),sess:this._auth.getSessionToken(),version:this._testStateVersion,remoteSectionControl:!!window.TestEngine.getNavigation().getCurrentSection()&&window.TestEngine.getNavigation().getCurrentSection().getRemoteSectionControl(),testnavEventQueue:window.TestEngine._testnavEventQueue}):JSON.stringify({state:t.data,ts:t.timestamp,u_sess:this._auth.getLoginToken(),sess:this._auth.getSessionToken(),version:this._testStateVersion,remoteSectionControl:!!window.TestEngine.getNavigation().getCurrentSection()&&window.TestEngine.getNavigation().getCurrentSection().getRemoteSectionControl(),testnavEventQueue:window.TestEngine._testnavEventQueue}),window.TestEngine._native?window.TestEngine._native.compressContent(i):window.TestEngine.getGenericNativeComponent().compressContent(i)},e.prototype.isTestSecure=function(){var e=window.TestEngine._state;return 3!==parseInt(e._securityLevel)},e.prototype.generateAjaxPostRetrieveSettings=function(e,t,n){var i={};return i.data=JSON.stringify({u_sess:this._auth.getLoginToken(),sess:this._auth.getSessionToken()?this._auth.getSessionToken():this._auth.getLastSessionToken(),enforceStatusCheck:!n}),i.context=this,i.success=t,i.error=t,i},e.prototype.transmitToServer=function(t,n,i,s,r,o,a){var c,u=window.TestEngine._state;if(c=this.deepCopyState(t),this._devMode)i===e.ITEM?this._tempStorage.addMessage(t.getItemId(),c):this._tempStorage.addMessage(t.getTestId(),{state:c});else{if(!l)var l=function(e){console.log(e)};this._lastResponse=c.data.state?JSON.stringify(c.data.state):void 0;var d=this.generateAjaxPostSettings(c,i,s,r,o,a);window.TestEngine._serverInterface.setMultipleItemStates(n,d.data,d.success,d.error,u)}},e.prototype.getItemVersion=function(e){var t,n=window.TestEngine._state,i=function(){n._localItemCache.length>0&&_.each(n._localItemCache,function(n,i){parseInt(n.itemId)===parseInt(e)&&(t=n)})};return i(),t?t.version:-1},e.prototype.retrieveState=function(e,t,n,i){var s,r,o=this,a="",c=e.toJSON().itemId,u=window.TestEngine._testInformation.gotAllStates,l=function(e){o.prepareTestStateForClient(e,i,n)},d=function(){o._localItemCache.length>0&&_.each(o._localItemCache,function(e,t){parseInt(e.itemId)===parseInt(c)&&(s=e)})};if(this._practiceTestMode){var g;return d(),s?g={success:"yes",state:s.state}:window.TestEngine._testInformation.gotAllStates?g={success:"yes",state:{data:{data:{}}}}:(g={},window.TestEngine._testInformation.gotAllStates=!0),void i.call(n,g)}"test"===t?(r=l,a="/getAllStates/"+this._auth.getLoginId()):(d(),s&&(g={success:"yes",state:s.state},i.call(n,g))),s||u?!s&&u&&(g={success:"yes",state:{data:{data:{}}}},i.call(n,g)):(this.retrieveFromServer(e,a,t,r,n),window.TestEngine._testInformation.gotAllStates=!0)},e.prototype.retrieveStateForSRF=function(t,n,i){var r="";if(this._practiceTestMode)return void i.call(n);var o=new s.TestEngine.TestStateData;o.initialize(t,this._auth.getUserName(),{}),r="/getAllStates/"+window.TestEngine._auth.getLoginId(),this.retrieveFromServer(o,r,e.TEST,i,n,!0)},e.prototype.prepareTestStateForClient=function(e,t,n){var i,s=0,r=0,o=this;if(e||(e={success:"no"}),("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),"null"===e.testState?e.testState=null:e.version&&(o._testStateVersion=e.version),"null"===e.itemState&&(e.itemState=null),e.itemState){for(s=e.itemState.length;r<s;r+=1)if(i=e.itemState[r],i.itemId){var a=!0;_.each(this._localItemCache,function(e,t){parseInt(e.itemId)===parseInt(i.itemId)&&(e.version<i.version&&(o._localItemCache[t]={itemId:i.itemId,state:i.state,version:i.version,itemOrder:i.itemOrder}),a=!1)}),a&&this._localItemCache.push({itemId:i.itemId,state:i.state,version:i.version,itemOrder:i.itemOrder})}else console.warn("no state for this item to save. Item#:"+r);r=0}var c;c="no"===e.success?{success:e.success,msg:e.msg,errorType:e.msgCode,errorNum:e.errorNum,command:e.command}:{success:e.success,state:e.testState},t.call(n,c)},e.prototype.transmitState=function(e,t,n,i,s,r,o,a,c){var u=this;this._isFinalSave=r;var l,d;try{d=TN8.Application.config.bundleSize?TN8.Application.config.bundleSize:3}catch(e){d=3}if(r&&e.getNavigation().stopPreloading(),(3===parseInt(e._state._securityLevel)||e.getNavigation().getCurrentSection()&&(e.getNavigation().getCurrentSection().getRemoteSectionControl()||!e.getNavigation().getCurrentSection().isLinear()))&&(d=1),u._lastSavedTestState=t._data.test_state,"test"!==n.toLowerCase()&&this.addItemToBundleArr(t,n,d),this._practiceTestMode){if(null!==c&&void 0!==c){var g=$.parseJSON('{"success":"yes", "msg":"State not saved due to practice mode"}');e._isResponseSendingInProgress=!1,c.call(this,g)}}else{var p=function(){e._state.transmitState(e,t,n,a?i:$.proxy(i,e,!0,p),null,r,!0,!0,c)};e._ewsReryFuncArgs=[],e._ewsReryFunc=p;var h=i;if(a||(h=$.proxy(i,e,!1,p)),"test"!==n.toLowerCase()){if(u._localItemCache.readyToSendBundle!==!0&&r!==!0&&o!==!0){var g=$.parseJSON('{"success":"no", "error":"9999", "msg":"State saved to local cache for future transmission."}');return void h.call(this,g)}l=this.getEndpoint(t,"itemBundle"),t._data.test_state&&u._testStateVersion++;var f=JSON.parse(JSON.stringify(t));f.data.state=u.getBundlePrepared(),this.transmitToServer(f,l,n,h,null,r)}else if(u._testStateVersion++,this._localItemCache.bundleArr.length>0){l=this.getEndpoint(t,"itemBundle"),u._lastSavedTestState=t._data;var m={data:{test_state:t._data,state:u.getBundlePrepared()}};m.timestamp=(new Date).getTime(),this.transmitToServer(m,l,"item",h,null,r)}else u._lastSavedTestState=t._data,l=this.getEndpoint(t,"test"),this.transmitToServer(t,l,n,h,s)}},e.prototype.bufferItemResponses=function(e){var t=this;_.each(e,function(e,n){var i={};i.itemId=e.itemId,i.state=e.state,i.timeStamp=e.timestamp?e.timestamp:e.timeStamp,i.version=e.version,i.itemOrder=e.itemOrder,t._localItemCache.bundleArr.push(i)})},e.prototype.addItemToBundleArr=function(e,t,n){var i,s=!1,r={},o=e.toJSON();"test"!==t.toLowerCase()&&(r.itemId=o.itemId,r.state=o.data.state,r.timeStamp=o.timestamp,r.version=o.version,r.itemOrder=o.itemOrder,this._localItemCache.length>0&&_.each(this._localItemCache,function(e,t){parseInt(e.itemId)===parseInt(r.itemId)&&(i=t,_.isEqual(e,r)&&(s=!0))})),s||i>=0?(i>=0&&!s&&(this._localItemCache[i]=r,this._localItemCache.bundleArr.push(r)),this._localItemCache.bundleArr.length>=n&&(this._localItemCache.readyToSendBundle=!0)):(this._localItemCache.push(r),this._localItemCache.bundleArr.push(r),this._localItemCache.bundleArr.length>=n&&(this._localItemCache.readyToSendBundle=!0)),this._lastSavedTestState=e._data.test_state},e.prototype.flushItemBundle=function(e,t,n){var i=window.TestEngine._state;if(this._practiceTestMode||n&&i._localItemCache.bundleArr.length<=0)return void e.call(n,{success:"yes",skipped:!0});var s={data:{test_state:i._lastSavedTestState,state:i.getBundlePrepared()}},r=i.deepCopyState(s),o=i.getEndpoint(s,"itemBundle");i.transmitToServer(r,o,"item",e,null,!1,t)},e.prototype.flushTestState=function(e,t,n){var i=window.TestEngine._state;if(this._practiceTestMode)return void e.call(n,{success:"yes"});var s={data:i._lastSavedTestState},r=i.deepCopyState(s),o=i.getEndpoint(s,"test");i.transmitToServer(r,o,"test",e,null,!1,t)},e.prototype.getBundlePrepared=function(){for(var e,t=this,n=0,i=t._localItemCache.bundleArr.length,s={},r=[];n<i;n+=1)e=t._localItemCache.bundleArr[n],s={},s[e.itemId]={state:e.state,timeStamp:e.timeStamp,version:e.version,itemOrder:e.itemOrder},r.push(s);return r},e.prototype.destroyLocalItemCache=function(){this._localItemCache&&this._localItemCache.length>0&&(this._localItemCache.length=0,
this._localItemCache.bundleArr&&this._localItemCache.bundleArr.length>0&&(this._localItemCache.bundleArr.length=0),this._localItemCache.readyToSendBundle=!1)},e.prototype.buildTestState=function(e,t){var n=new s.TestEngine.TestStateData;return n.initialize(e,this._auth.getUserName(),t),n},e.prototype.getTestState=function(t,n,i){var r=new s.TestEngine.TestStateData;r.initialize(t,this._auth.getUserName(),{}),this.retrieveState(r,e.TEST,n,i)},e.prototype.setTestState=function(t,n,i,r,o){var a=this,c=new s.TestEngine.TestStateData;c.initialize(t,this._auth.getUserName(),n);var u=window.TestEngine;if(3!==parseInt(u._state._securityLevel)){u._state._lastSavedTestState=n;var l=$.proxy(a.saveTestStateCallback,a,u,i,n,r,t,a._localItemCache.bundleArr.length>0),d=function(s){var o=$.proxy(u.storeTestStateToFile,null,n,l,r,t);a.transmitState(u,c,e.TEST,l,o,r,!1,!1,i)};u._native.checkForBlackList(d)}else{var g=$.proxy(a.saveTestStateCallbackL3,a,u,i,a._localItemCache.bundleArr.length>0);a.transmitState(u,c,e.TEST,g,null,r,!1,!1,i)}},e.prototype.saveTestStateCallback=function(e,t,n,i,s,r,o,a,c){if("yes"!==c.success&&!c.msgCode){var u=$.proxy(this.saveTestStateSRFCallback,this,e,i,a);return void e.storeTestStateToFile(n,u,i,s)}e.storeTestStateFailed=!1,e.resetAfterSuccessfulSave.call(e,r),t(c)},e.prototype.saveTestStateCallbackL3=function(e,t,n,i,s,r){e.storeTestStateFailed=!1,e.resetAfterSuccessfulSave.call(e,n),t(r)},e.prototype.saveTestStateSRFCallback=function(e,t,n){t?e.ewsError(e,'{"success":"no","errorcode":"1008","msg":"Failed to save to server on final save"}',n,[],!0):e.ewsError(e,'{"success":"no","errorcode":"1021","msg":"Failed to save to server"}',n,[],!0),e._isResponseSendingInProgress=!1},e.prototype.getItemResponse=function(t,n,i,r){var o=new s.TestEngine.ItemStateData;o.initialize(t,this._auth.getUserName(),n,{}),this.retrieveState(o,e.ITEM,i,r)},e.prototype.getAllItemResponses=function(){var e=window.TestEngine._state,t=new Array;return e._localItemCache.length>0&&_.each(e._localItemCache,function(e,n){var i={};i[e.itemId]=e,t.push(i)}),t},e.prototype.setItemResponse=function(e,t,n,i,r,o){var a=new s.TestEngine.ItemStateData;return a.initialize(e,this._auth.getUserName(),t,n,r,o),a},e.prototype.getAllTestState=function(){var e={};e.dataType="json",e.type="POST",e.timeout=15e3,e.success=function(e){console.log(e)},e.error=function(e,t,n){console.log(e,t,n)},e.data="{ u_sess:"+this._auth.getLoginToken()+", sess:"+this._auth.getSessionToken()+"}",e.url=this._apiBaseUrl+"/getAllStates/"+this._auth.getLoginId(),$.ajax(e)},e.prototype.setSecurityLevel=function(e){this._securityLevel=e,this.setSecurityString(e)},e.prototype.setSecurityString=function(e){"1"===e||"2"===e?this._secureUrlString="/secure":this._secureUrlString=""},e.prototype.getPracticeTestMode=function(){return this._practiceTestMode},e.prototype.setPracticeTestMode=function(e){this._practiceTestMode=e},e.prototype.setApiBaseUrl=function(e){this._apiBaseUrl=e},e}();e.State=t;var n=function(){function e(e,t){this.id=e,this.message=t}return e}(),i=function(){function e(){this.storage=[]}return e.prototype.addMessage=function(e,t){for(var i=!1,s=0;s<this.storage.length;s++){var r=this.storage[s];r.id===e&&(r.message=t,i=!0)}i===!1&&this.storage.push(new n(e,t))},e.prototype.getMessage=function(e){for(var t=0;t<this.storage.length;t++){var n=this.storage[t];if(n.id===e)return n.message}},e}()}(t.TestEngine||(t.TestEngine={}))}),define("ServerInterface",["require","exports"],function(e,t){var n=function(){function e(){this._genericNative=void 0}function t(e,t){var n=function(n){var i=n.msg;!i||i.indexOf("responseCode")===-1||i.indexOf("504")===-1||i.indexOf("timeout")===-1&&i.indexOf("timed out")===-1||(n.errorNum=504),n.command=e,t(n)};return n}return e.prototype.getTestDefine=function(e,n,i){var s=this,r=[],o="getTestDefine";s.executeCommand(o,e,t(o,n),i,s.getMiddle().getTestDefine,r)},e.prototype.getItemFlavor=function(e,t,n,i){var s=this,r=[e],o=window.TestEngine.getTestDefine().getItemContentVersion(e),a="getItemFlavor";s.executeCommand(a,t,n,i,s.getMiddle().getItemFlavor,r,o)},e.prototype.preloadResources=function(e,t,n,i,s){var r=this,o=[e],a="preloadResources";r.executeCommand(a,t,n,i,r.getMiddle().preloadResources,o,s)},e.prototype.getCATConfig=function(e,n,i,s){var r=this,o=[e],a="getCATConfig";r.executeCommand(a,n,t(a,i),s,r.getMiddle().getCATConfig,o)},e.prototype.navigateAndSaveCAT=function(e,n,i,s,r){var o=this,a=[e,n],c="navigateAndSaveCAT";o.executeCommand(c,i,t(c,s),r,o.getMiddle().navigateAndSaveCAT,a)},e.prototype.scoreResponse=function(e,n,i,s,r){var o=this,a=[e,n],c="scoreResponse";o.executeCommand(c,i,t(c,s),r,o.getMiddle().scoreResponse,a)},e.prototype.getCorrectTestCases=function(e,t,n,i){var s=this,r=[e];s.executeCommand("getCorrectTestCases",t,n,i,s.getMiddle().getCorrectTestCases,r)},e.prototype.scoreFeedback=function(e,t,n,i,s){var r=this,o=[e,t];r.executeCommand("scoreFeedback",n,i,s,r.getMiddle().scoreFeedback,o)},e.prototype.getSectionProctorDetails=function(e,n,i,s,r){var o=this,a=[e,n],c="getSectionProctorDetails";o.executeCommand(c,i,t(c,s),r,o.getMiddle().getSectionProctorDetails,a)},e.prototype.setMultipleItemStates=function(e,t,n,i,s){var r=this,o=[e,t],a="setMultipleItemStates";r.executeCommand(a,n,i,s,r.getMiddle().setMultipleItemStates,o)},e.prototype.getAllStates=function(e,t,n,i,s){var r=this,o=[e,t],a="getAllStates";r.executeCommand(a,n,i,s,r.getMiddle().getAllStates,o)},e.prototype.exitTest=function(e,t,n,i,s){var r=this,o=[e,t],a="exitTest";r.executeCommand(a,n,i,s,r.getMiddle().exitTest,o)},e.prototype.submitTest=function(e,t,n,i,s){var r=this,o=[e,t],a="submitTest";r.executeCommand(a,n,i,s,r.getMiddle().submitTest,o)},e.prototype.remoteSectionControlConfig=function(e,n,i,s,r){var o=this,a=[e,n],c="getSectionProctorDetails";o.executeCommand(c,i,t(c,s),r,o.getMiddle().getSectionProctorDetails,a)},e.prototype.executeCommand=function(e,t,n,i,s,r,o){var a=this,c=1,u=2e3,l=function(l){if(l.setCommand=e,l.setSuccessCallback(t),l.setFailureCallback(n),l.setContext(i),l.setPayload(o),"preloadResources"===e&&l.setChecksumMapper(TestEngine.checksumData),l.isSuccess())"navigateAndSaveCAT"===e&&c>1&&$(document).trigger("tn.retryNavigateSuccess",c),l.process();else{var d=a.getMiddle().getRetryAttempts(e);if("preloadResources"===e&&l.isAbortedRequest()&&(d+=2),c>=d)l.process();else{var g=function(){a.executeCommand(e,t,n,i,s,r),c++};"navigateAndSaveCAT"===e||"setMultipleItemStates"===e?setTimeout(g,u*c):g()}}};r.push(l),s.apply(a.getMiddle(),r)},e.prototype.getMiddle=function(){return!TestEngine.getNativeComponent()||window.TestEngine.isNonIOSApp()&&3===parseInt(TestEngine._state._securityLevel)?(TestEngine._serverInterface._genericNative||(TestEngine._serverInterface._genericNative=new window.TestEngine.NativeLib.TestEngine.Native),TestEngine._serverInterface._genericNative):TestEngine.getNativeComponent()},e}();t.ServerInterface=n}),define("JSTreeToQTI",["require","exports"],function(e,t){!function(e){var t=function(){function e(){}return e.parseAttributes=function(t){var n="",i={};for(var s in t){var r=t[s];switch(s){case"itemId":i.href="../api/8.0/item/"+r+"/flavor/1",i.itemName=t.id;break;case"id":t.itemId?i.id=t.itemId:i.id=r;break;case"title":i.title=r;break;case"ntype":n=e.resolveNodeName(r);break;default:i[s]=r}}var o={};return o[n]=i,o},e.parseChildren=function(t){var n=[];if("children"in t)for(var i=0;i<t.children.length;i++)n.push(e.translateObject(t.children[i]));return n},e.findChildArrayName=function(e){var t;switch(e){case"test":t="parts";break;case"part":t="sections";break;case"section":t="items"}return t},e.resolveNodeName=function(e){var t="";switch(e){case"assessment":t="test";break;case"item":t="itemRef";break;case"part":case"section":t=e}return t},e.translateObject=function(t){var n="",i={};if(i=e.parseAttributes(t.attr),n=t.attr.ntype?e.resolveNodeName(t.attr.ntype):null,"itemRef"!==n){var s=e.findChildArrayName(n),r=e.parseChildren(t);i[n][s]=r}return i},e.convertToQTI=function(t){var n=e.translateObject(t);return JSON.stringify(n)},e}();e.Converter=t}(t.JSTreeToQTI||(t.JSTreeToQTI={}))}),define("TestInformation/QTIElement",["require","exports"],function(e,t){!function(e){!function(e){var t=function(){function e(e,t){this._toolSetName=null,this._wc=!1,this._timer=null,this._identifier="",this._parent=e,t?this.setElementIndex(t):this.setElementIndex(0)}return e.prototype.getClassName=function(){return"QTIElement"},e.prototype.parseJson=function(e){this._identifier=String(e.id),e.wc&&(this._wc=e.wc);var t=String(e.title);this.setTitle(t),this._toolSetName=e.ts,null!==e.timer&&"undefined"!=typeof e.timer&&(this._timer=e.timer),e.sealCode&&(this._sealCode=e.sealCode)},e.prototype.getParent=function(){return this._parent},e.prototype.getIdentifier=function(){return this._identifier},e.prototype.getWc=function(){return this._wc},e.prototype.getTitle=function(){return this._title},e.prototype.setTitle=function(e){if(!e||"undefined"===e){var t=this.getClassName();t=t.replace("Assessment","");var n=this.getElementIndex()+1;e=t+" "+n}this._title=e},e.prototype.getElementIndex=function(){return this._elementIndex},e.prototype.setElementIndex=function(e){this._elementIndex=e},e.prototype.getToolset=function(){for(var e=this.getParent(),t=null;e.getParent();)e=e.getParent();return e.findToolset&&(t=e.findToolset(this._toolSetName)),t},e}();e.QTIElement=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("TestInformation/SiblingElement",["require","exports","./QTIElement"],function(e,t,n){var i=n;!function(e){!function(e){var t=function(e){function t(t,n){e.call(this,t,n),this._prevSibling=null,this._nextSibling=null}return __extends(t,e),t.prototype.getClassName=function(){return"SiblingElement"},t.prototype.setPreviousSibling=function(e){this._prevSibling=e},t.prototype.getPreviousSibling=function(){return this._prevSibling},t.prototype.setNextSibling=function(e){this._nextSibling=e},t.prototype.getNextSibling=function(){return this._nextSibling},t.prototype.setState=function(e){this._state=e},t.prototype.getState=function(){return this._state},t}(i.TestEngine.TestInformation.QTIElement);e.SiblingElement=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("TestInformation/ParentElement",["require","exports","./SiblingElement"],function(e,t,n){var i=n;!function(e){!function(e){var t=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.getClassName=function(){return"ParentElement"},t.prototype.crossLinkChildren=function(e){for(var t=0;t<e.length;t++){var n=e[t-1],i=e[t+1],s=e[t];null!==n&&void 0!==n&&s.setPreviousSibling(n),null!==i&&void 0!==i&&s.setNextSibling(i)}return e},t.prototype.getChildrenState=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].getState();t.push(i)}return t},t.prototype.createNewChild=function(e,t,n){var i=new t(this,n);return i.parseJson(e),i},t.prototype.createChildren=function(e,t){for(var n=[],i=0;i<e.length;i++){var s=this.createNewChild(e[i],t,i);n.push(s)}return n},t.prototype.getChildById=function(e,t){for(var n=0;n<e.length;n++)if(e[n].getIdentifier()===t)return e[n];return null},t}(i.TestEngine.TestInformation.SiblingElement);e.ParentElement=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("TestInformation/AssessmentItemRef",["require","exports","./SiblingElement"],function(e,t,n){var i=n;!function(e){!function(e){var t=function(e){function t(t,n){e.call(this,t,n),this._flagged=!1,this._answered=!1,this._visited=!1,this._href="",this._itemSet="",this._preloadStatus="NA",this._hn=!1,this._flavorsAvailable=[]}return __extends(t,e),t.PRELOAD_COMPLETE="preload_complete",t.PRELOAD_IN_PROGRESS="preload_in_progress",t.PRELOAD_FAILED="preload_failed",t.prototype.getClassName=function(){return"AssessmentItemRef"},t.prototype.getState=function(){return this.setState({itemRef:{flagged:this._flagged,id:this.getIdentifier(),title:this.getTitle(),answered:this._answered,visited:this._visited,wc:this.getWc()}}),e.prototype.getState.call(this)},t.prototype.parseJson=function(t){t=t.itemRef,e.prototype.parseJson.call(this,t),this._href=String(t.href),this._flavorsAvailable=t.flavorsAvailable?t.flavorsAvailable:[],t.wc&&(this._wc=t.wc),void 0!==t.is&&(this._itemSet=String(t.is)),this._itemName=t.itemName,this._itemContentVersion=t.contentVersion?t.contentVersion+"":void 0,this._hn=!!t.hn&&"true"===t.hn.toString()},t.prototype.getFlagged=function(){return this._flagged},t.prototype.getItemContentVersion=function(){return this._itemContentVersion},t.prototype.getFlavorsAvailable=function(){return this._flavorsAvailable},t.prototype.setFlagged=function(e){this._flagged=e},t.prototype.getAnswered=function(){return this._answered},t.prototype.setAnswered=function(e){this._answered=e},t.prototype.getVisited=function(){return this._visited},t.prototype.setVisited=function(e){this._visited=e},t.prototype.getHref=function(){return this._href},t.prototype.setHref=function(e){this._href=e},t.prototype.getItemSet=function(){return this._itemSet},t.prototype.setItemSet=function(e){this._itemSet=e},t.prototype.isPreloaded=function(){return this._preloadStatus===t.PRELOAD_COMPLETE},t.prototype.isPreloadInProgress=function(){return this._preloadStatus===t.PRELOAD_IN_PROGRESS},t.prototype.hasPreloadFailed=function(){return this._preloadStatus===t.PRELOAD_FAILED},t.prototype.setPreloaded=function(){this._preloadStatus=t.PRELOAD_COMPLETE},t.prototype.setPreloadInProgress=function(){this._preloadStatus=t.PRELOAD_IN_PROGRESS},t.prototype.setPreloadFailed=function(){this._preloadStatus=t.PRELOAD_FAILED},t.prototype.setTitle=function(t){var n=this.getElementIndex()+1;t&&"undefined"!==t||"AssessmentItemRef"===this.constructor.name&&(this._wc||(t="Question "+n)),"AssessmentItemRef"===this.constructor.name&&(this._wc||(t=n+". "+t)),e.prototype.setTitle.call(this,t)},t.prototype.getItemName=function(){return this._itemName},t.prototype.hideNavigation=function(){return this._hn},t}(i.TestEngine.TestInformation.SiblingElement);e.AssessmentItemRef=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("TestInformation/AssessmentSection",["require","exports","./ParentElement","./AssessmentItemRef"],function(e,t,n,i){var s=n,r=i;!function(e){!function(e){var t=function(e){function t(t,n){e.call(this,t,n),this._locked=!1,this._visible=!0,this._sealCode=!1,this._timer=null,this._timerEnabled=!1,this._timeRemaining=null,this._sOvertime=null,this._allowReentry=!1,this._mustAnswerToContinue=!1,this._assessmentItemRefs=[],this._visited=!1,this._linear=!0,this._remoteSectionControl=!1,this._disableSectionExit=!1,this._skipItemInRange=!1,this._htw=!1,this._hideSectionReview=!1,this._skipStart=!1,this._skipEnd=!1,this._continuationSectionIdentifier,this._continuedFromSectionId,this._parent=t}return __extends(t,e),t.prototype.getClassName=function(){return"AssessmentSection"},t.prototype.getState=function(){var t=this.getChildrenState(this._assessmentItemRefs);return this.setState({section:{id:this.getIdentifier(),title:this.getTitle(),sealCode:this._sealCode,timer:this._timer,locked:this._locked,timerEnabled:this._timerEnabled,timeRemaining:this._timeRemaining,items:t,visited:this._visited,sOvertime:this._sOvertime,sessionToken:this._sessionToken}}),window.TestEngine.UtilsLib.TestEngine.Utils.deepCopy(e.prototype.getState.call(this))},t.prototype.parseJson=function(t){t=t.section,e.prototype.parseJson.call(this,t),this._mustAnswerToContinue=t.mustAnswerToContinue&&"true"===t.mustAnswerToContinue.toString(),this._locked=this._sealCode,this._timerEnabled=void 0!==t._timerEnabled&&t._timerEnabled,this._rubricblock=t.rubricblock||void 0,this._visible=t.visible&&"true"===t.visible.toString(),this.setAllowReentry(t.allowReentry&&"true"===t.allowReentry.toString()),this._linear=void 0===t.linear||t.linear,this._remoteSectionControl=t.remoteSectionControl,this._disableSectionExit=t.disableExit,this._skipItemInRange=!!t.skipItemInRange&&"true"===t.skipItemInRange.toString(),this._htw=!!t.htw&&"true"===t.htw.toString(),this._hideSectionReview=!!t.hideSectionReview&&"true"===t.hideSectionReview.toString(),this._skipStart=!!t.skipStart&&"true"===t.skipStart.toString(),this._skipEnd=!!t.skipEnd&&"true"===t.skipEnd.toString(),t.continuationSectionIdentifier&&(this._continuationSectionIdentifier=t.continuationSectionIdentifier),this._assessmentItemRefs=this.createChildren(t.items,r.TestEngine.TestInformation.AssessmentItemRef),this._assessmentItemRefs=this.crossLinkChildren(this._assessmentItemRefs)},t.prototype.getIndexOfItem=function(e){for(var t=0;t<this._assessmentItemRefs.length;t++)if(this._assessmentItemRefs[t]===e)return t+1},t.prototype.getItemByName=function(e){for(var t=0;t<this._assessmentItemRefs.length;t++)if(this._assessmentItemRefs[t].getItemName()===e)return this._assessmentItemRefs[t];return null},t.prototype.getIndexOfQuestionItem=function(e){var t;t=0;for(var n=0;n<this._assessmentItemRefs.length;n++)if(!this._assessmentItemRefs[n]._wc&&(t++,this._assessmentItemRefs[n]===e))return t},t.prototype.setTitle=function(e){if(!e||"undefined"===e){var t=this.getElementIndex()+1,n=window.TestEngine.getLocalizedString("section");e=n+" "+t}this._title=e},t.prototype.getChildById=function(t){return e.prototype.getChildById.call(this,this._assessmentItemRefs,t)},t.prototype.getFirstItem=function(){return this._assessmentItemRefs[0]},t.prototype.getNumberOfItems=function(){for(var e=0,t=0,n=this._assessmentItemRefs.length;t<n;t+=1)e+=1;return e},t.prototype.getNumberOfQuestionItems=function(){for(var e=0,t=0,n=this._assessmentItemRefs.length;t<n;t+=1)this._assessmentItemRefs[t]._wc||(e+=1);return e},t.prototype.getNumberOfWcItems=function(){for(var e=0,t=0,n=this._assessmentItemRefs.length;t<n;t+=1)this._assessmentItemRefs[t]._wc&&(e+=1);return e},t.prototype.getNumberOfAnsweredItems=function(){for(var e=0,t=0;t<this._assessmentItemRefs.length;t++)this._assessmentItemRefs[t].getAnswered()&&!this._assessmentItemRefs[t].getWc()&&e++;return e},t.prototype.getNumberOfUnansweredItems=function(){return this.getNumberOfItems()-this.getNumberOfWcItems()-this.getNumberOfAnsweredItems()},t.prototype.getAssessmentItemRefById=function(e){for(var t=0;t<this._assessmentItemRefs.length;t++)if(this._assessmentItemRefs[t].getIdentifier()===e)return this._assessmentItemRefs[t]},t.prototype.getAssessmentItemRefs=function(){return this._assessmentItemRefs},t.prototype.getLocked=function(){return this._locked},t.prototype.setLocked=function(e){this._locked=e},t.prototype.getVisible=function(){return this._visible},t.prototype.setVisible=function(e){this._visible=e},t.prototype.getSealCode=function(){return this._sealCode},t.prototype.setSealCode=function(e){this._sealCode=e},t.prototype.getTimerEnabled=function(){return this._timerEnabled},t.prototype.setTimerEnabled=function(e){this._timerEnabled=e},t.prototype.getTimeRemaining=function(){return this._timeRemaining},t.prototype.setTimeRemaining=function(e){this._timeRemaining=e},t.prototype.setSOvertime=function(e){this._sOvertime=e},t.prototype.getSOvertime=function(){return this._sOvertime},t.prototype.setTimer=function(e){this._timer=e},t.prototype.getTimer=function(){return this._timer},t.prototype.getAllowReentry=function(){return this._allowReentry},t.prototype.setAllowReentry=function(e){this._allowReentry=e},t.prototype.getMustAnswerToContinue=function(){return this._mustAnswerToContinue},t.prototype.setMustAnswerToContinue=function(e){this._mustAnswerToContinue=e},t.prototype.getVisited=function(){return this._visited},t.prototype.setVisited=function(e){this._visited=e},t.prototype.getRubricblock=function(){return this._rubricblock},t.prototype.isLinear=function(){return this._linear},t.prototype.getRemoteSectionControl=function(){return this._remoteSectionControl===!0},t.prototype.getDisableExit=function(){return this._disableSectionExit===!0},t.prototype.setSessionToken=function(e){var t=window.TN8.TestStateController.getSectionClass(this._parent.getIdentifier(),this.getIdentifier());t&&t.set("sessionToken",e)},t.prototype.setAdaptiveState=function(e){var t=window.TN8.TestStateController.getTestStateRoot();if(t){var n=t.get("adaptive_state");n||(n={}),n[this.getIdentifier()]=e,t.set("adaptive_state",n)}},t.prototype.getSessionToken=function(){var e=window.TN8.TestStateController.getSectionClass(this._parent.getIdentifier(),this.getIdentifier());if(e)return e.get("sessionToken")},t.prototype.setCATData=function(e){this._catData=e},t.prototype.getCATData=function(){return this._catData},t.prototype.getAdaptiveState=function(){var e=window.TN8.TestStateController.getTestStateRoot(),t=e.get("adaptive_state");return t?t[this.getIdentifier()]:null},t.prototype.skipItemInRange=function(){return this._skipItemInRange},t.prototype.hideSectionReview=function(){return this._hideSectionReview},t.prototype.hideTimerWarning=function(){return this._htw},t.prototype.skipStart=function(){return this._skipStart},t.prototype.skipEnd=function(){return this._skipEnd},t.prototype.setContinuedFromSectionId=function(e){this._continuedFromSectionId=e},t.prototype.getContinuedFromSectionId=function(){return this._continuedFromSectionId},t.prototype.getContinuationSectionIdentifier=function(){return this._continuationSectionIdentifier},t}(s.TestEngine.TestInformation.ParentElement);e.AssessmentSection=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("TestInformation/TestPart",["require","exports","./ParentElement","./AssessmentSection"],function(e,t,n,i){var s=n,r=i;!function(e){!function(e){var t=function(e){function t(t){e.call(this,t),this._assessmentSections=[],this._navigationMode="",this._submissionMode="",this._timer=null,this._timerEnabled=!1,this._timeRemaining=null,this._pOvertime=null,this._status="N"}return __extends(t,e),t.prototype.getClassName=function(){return"TestPart"},t.prototype.getState=function(){var t=this.getChildrenState(this._assessmentSections);return this.setState({part:{navigationMode:this._navigationMode,submissionMode:this._submissionMode,sections:t}}),e.prototype.getState.call(this)},t.prototype.parseJson=function(t){t=t.part,e.prototype.parseJson.call(this,t),this._navigationMode=t.navigationMode,this._submissionMode=t.submissionMode,this._countdown=t.countdown,this._assessmentSections=this.createChildren(t.sections,r.TestEngine.TestInformation.AssessmentSection),this._assessmentSections=this.crossLinkChildren(this._assessmentSections)},t.prototype.getChildById=function(t){return e.prototype.getChildById.call(this,this._assessmentSections,t)},t.prototype.getItemById=function(e){for(var t=0;t<this._assessmentSections.length;t++){var n=this._assessmentSections[t],i=n.getChildById(e+"");if(null!==i&&void 0!==i)return i}return null},t.prototype.getNumberOfItems=function(){for(var e=0,t=0;t<this._assessmentSections.length;t++)e+=this._assessmentSections[t].getNumberOfItems();return e},t.prototype.getNumberOfAnsweredItems=function(){for(var e=0,t=0;t<this._assessmentSections.length;t++)e+=this._assessmentSections[t].getNumberOfAnsweredItems();return e},t.prototype.getNumberOfUnansweredItems=function(){for(var e=0,t=0;t<this._assessmentSections.length;t++)e+=this._assessmentSections[t].getNumberOfUnansweredItems();return e},t.prototype.getFirstSection=function(){return this._assessmentSections[0]},t.prototype.getAssessmentSections=function(){return this._assessmentSections},t.prototype.getNavigationMode=function(){return this._navigationMode},t.prototype.setNavigationMode=function(e){this._navigationMode=e},t.prototype.getSubmissionMode=function(){return this._submissionMode},t.prototype.setSubmissionMode=function(e){this._submissionMode=e},t.prototype.getTimerEnabled=function(){return this._timerEnabled},t.prototype.setTimerEnabled=function(e){this._timerEnabled=e},t.prototype.getTimeRemaining=function(){return this._timeRemaining},t.prototype.setTimeRemaining=function(e){this._timeRemaining=e},t.prototype.setPOvertime=function(e){this._pOvertime=e},t.prototype.getPOvertime=function(){return this._pOvertime},t.prototype.setCountdown=function(e){this._countdown=e},t.prototype.getCountdown=function(){return this._countdown},t.prototype.getStatus=function(){return this._status},t.prototype.setStatus=function(e){this._status=e},t.prototype.enter=function(){this.setStatus("N")},t.prototype.exit=function(){this.setStatus("E")},t.prototype.resume=function(){this.setStatus("R")},t.prototype.complete=function(){this.setStatus("C")},t.prototype.getSectionByIndex=function(e){return this._assessmentSections[e]},t.prototype.getSectionIndexById=function(e){for(var t=0;t<this._assessmentSections.length;t++)if(this._assessmentSections[t].getIdentifier()===e)return t;return-1},t.prototype.getSectionById=function(e){for(var t=0;t<this._assessmentSections.length;t++)if(this._assessmentSections[t].getIdentifier()===e)return this._assessmentSections[t]},t.prototype.getSectionByItemId=function(e){for(var t=0;t<this._assessmentSections.length;t++){var n=this._assessmentSections[t],i=n.getChildById(e);if(null!==i&&void 0!==i)return n}},t.prototype.hasAdaptiveSection=function(e){for(var t=0;t<this._assessmentSections.length;t++)if(!this._assessmentSections[t].isLinear())return!0;return!1},t}(s.TestEngine.TestInformation.ParentElement);e.TestPart=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n};define("TestInformation/AssessmentTest",["require","exports","./ParentElement","./TestPart"],function(e,t,n,i){var s=n,r=i;!function(e){!function(e){var t=function(e){function t(t){e.call(this,t),this._sourceJson=null,this._practiceTest=!1,this._tcenabled=!1,this._testParts=[],this._toolsets=[],this._encryption=!1,this._secured=!1,this._allowReview=!0,this._itemFeedback=!1,this._settingsScreen=!1,this._dynamicTTS=!1,this._globalVars={},this._scoringServiceRetrieved=!1,this._hideTimer=!1,this._studentToggleTimer=!1,this._hideCounter=!1,this._reviewRestrictionTime=0}return __extends(t,e),t.prototype.getClassName=function(){return"AssessmentTest"},t.prototype.parseJson=function(t){if("string"==typeof t?this._sourceJson=jQuery.parseJSON(t).test:this._sourceJson=t.test,e.prototype.parseJson.call(this,this._sourceJson),this._testParts=this.createChildren(this._sourceJson.parts,r.TestEngine.TestInformation.TestPart),this._testParts=this.crossLinkChildren(this._testParts),this._tcenabled=this._sourceJson.tcenabled===!0,this._toolsets=this._sourceJson.toolsets||[],this._rubricblock=this._sourceJson.rubricblock||void 0,this._securityLevel=this._sourceJson.securitylevel,this._testName=this._sourceJson.title,this._countdown=this._sourceJson.countdown,this._allowReview=void 0===this._sourceJson.allowReview||this._sourceJson.allowReview,this._itemFeedback=void 0!==this._sourceJson.itemFeedback&&this._sourceJson.itemFeedback,this._settingsScreen=void 0!==this._sourceJson.settingsScreen&&this._sourceJson.settingsScreen,this._dynamicTTS=void 0!==this._sourceJson.dynamicTTS&&this._sourceJson.dynamicTTS,this._globalVars=void 0!==this._sourceJson.globalVars?this._sourceJson.globalVars:{},this._chrome=this._sourceJson.chrome,this._scoreItems=this._sourceJson.scoreItems,this._hideTimer=this._sourceJson.hideTimer===!0,this._studentToggleTimer=this._sourceJson.studentToggleTimer===!0,this._hideCounter=this._sourceJson.hideCounter===!0,this._ttsScroll=this._sourceJson.ttsScroll===!0,window.TestEngine._testConfig&&this.setProxyConfig(window.TestEngine._testConfig),"saveresponses"in this._sourceJson&&(this._practiceTest=!Boolean(this._sourceJson.saveresponses)),"securitylevel"in this._sourceJson)switch(Number(this._sourceJson.securitylevel)){case 1:this._encryption=!0,this._secured=!0;break;case 2:this._encryption=!0}"reviewRestrictionTime"in this._sourceJson&&(this._reviewRestrictionTime=this._sourceJson.reviewRestrictionTime),this.assignParentSectionIdToContinuationSection()},t.prototype.findToolset=function(e){for(var t=[],n=0;n<this._toolsets.length;n++)if(this._toolsets[n].name===e){t=this._toolsets[n].tools;break}return t},t.prototype.assignParentSectionIdToContinuationSection=function(){for(var e=0;e<this._testParts.length;e++)for(var t=0;t<this._testParts[e].getAssessmentSections().length;t++){var n=this._testParts[e].getAssessmentSections()[t];if(!n.isLinear()&&n.getContinuationSectionIdentifier()){var i=this.getSectionById(n.getContinuationSectionIdentifier());i.setContinuedFromSectionId(n.getIdentifier())}}},t.prototype.getAbsolutePositionOfItem=function(e){for(var t=e.getParent().getPreviousSibling(),n=e.getParent().getIndexOfItem(e);null!==t&&void 0!==t;)n+=t.getNumberOfItems(),t=t.getPreviousSibling();return n},t.prototype.getNumberOfItems=function(){for(var e=0,t=0;t<this._testParts.length;t++)e+=this._testParts[t].getNumberOfItems();return e},t.prototype.getNumberOfAnsweredItems=function(){for(var e=0,t=0;t<this._testParts.length;t++)e+=this._testParts[t].getNumberOfAnsweredItems();return e},t.prototype.getNumberOfUnansweredItems=function(){for(var e=0,t=0;t<this._testParts.length;t++)e+=this._testParts[t].getNumberOfUnansweredItems();return e},t.prototype.isEncrypted=function(){return this._encryption},t.prototype.isLocked=function(){return this._secured},t.prototype.isPracticeTest=function(){return this._practiceTest},t.prototype.getTestParts=function(){return this._testParts},t.prototype.getTestId=function(){return this.getIdentifier()},t.prototype.getTCEnabled=function(){return this._tcenabled},t.prototype.getToolsets=function(){return this._toolsets},t.prototype.getRubricblock=function(){return this._rubricblock},t.prototype.getTestSecurityLevel=function(){return this._securityLevel},t.prototype.getTestName=function(){return this._testName},t.prototype.getProxyConfig=function(){return this._config},t.prototype.setProxyConfig=function(e){this._config=e},t.prototype.getCountdown=function(){return this._countdown},t.prototype.allowReview=function(){return this._allowReview},t.prototype.itemFeedback=function(){return this._itemFeedback},t.prototype.settingsScreen=function(){return this._settingsScreen},t.prototype.isDynamicTTS=function(){return this._dynamicTTS},t.prototype.getGlobalVars=function(){return this._globalVars},t.prototype.getChrome=function(){return this._chrome},t.prototype.scoreItems=function(){return this._scoreItems},t.prototype.isScoringServiceConfigRetrieved=function(){return this._scoringServiceRetrieved},t.prototype.hideTimer=function(){return this._hideTimer},t.prototype.setScoringServiceConfigRetrieved=function(e){this._scoringServiceRetrieved=!0},t.prototype.getTestPartsForTestState=function(){for(var e=this.getChildrenState(this._testParts),t=0;t<e.length;t++)e[t].part.id=this._testParts[t].getIdentifier();var n={parts:e,globals:this._globalVars};return window.TestEngine.UtilsLib.TestEngine.Utils.deepCopy(n)},t.prototype.getItemContentVersion=function(e){for(var t=0;t<this._testParts.length;t++){var n=this._testParts[t].getItemById(e);if(n)return n.getItemContentVersion()}},t.prototype.getStudentToggleTimer=function(){return this._studentToggleTimer;
},t.prototype.getHideCounter=function(){return this._hideCounter},t.prototype.getReviewRestrictionTime=function(){return this._reviewRestrictionTime},t.prototype.getTTSScroll=function(){return this._ttsScroll},t.prototype.getSectionById=function(e){for(var t=0;t<this._testParts.length;t++){var n=this._testParts[t].getSectionById(e);if(n)return n}},t.prototype.getPartById=function(e){for(var t=0;t<this._testParts.length;t++)if(e===this._testParts[t].getIdentifier())return this._testParts[t]},t}(s.TestEngine.TestInformation.ParentElement);e.AssessmentTest=t}(e.TestInformation||(e.TestInformation={}));e.TestInformation}(t.TestEngine||(t.TestEngine={}))}),define("Response",["require","exports"],function(e,t){var n=function(){function e(){}return e.prototype.BuildResponse=function(e,t,n,i,s,r){return e&&(this._command=e),t&&(this._successCallback=t),n&&(this._failureCallback=n),i&&(this._result=i),s&&(this._message=s),r&&(this._headers=r),this},e.prototype.setCommand=function(e){this._command=e},e.prototype.getCommand=function(){return this._command},e.prototype.setAbortedRequest=function(){this._isAbortedRequest=!0},e.prototype.isAbortedRequest=function(){return this._isAbortedRequest},e.prototype.setSuccessCallback=function(e){this._successCallback=e},e.prototype.getSuccessCallback=function(){return this._successCallback},e.prototype.setFailureCallback=function(e){this._failureCallback=e},e.prototype.getFailureCallback=function(){return this._failureCallback},e.prototype.isSuccess=function(){return this._result},e.prototype.setMessage=function(e){this._message=e},e.prototype.setContext=function(e){this._context=e},e.prototype.setPayload=function(e){this._payload=e},e.prototype.getMessage=function(){return this._message},e.prototype.setHeaders=function(e){this._headers=e},e.prototype.setChecksumMapper=function(e){this._checksumMapper=e},e.prototype.setHeadersFromString=function(e){this._headers=parseResponseHeaders(e)},e.prototype.setValidationResult=function(e){this._validationResult=e},e.prototype.getHeaderValue=function(e){var t=this.getHeader(e);return t.length>0?t[0].headerValue:null},e.prototype.process=function(){var e=this.validate(),t=this._message;return this._result||"yes"!==e.success?("no"===e.success&&(t=e),void(this._successCallback&&this._successCallback.call(this._context,t))):void(this._failureCallback&&this._failureCallback.call(this._context,this._message))},e.prototype.parseResponseHeaders=function(e,t){var n={};if(!t)return n;for(var i=t.split("\r\n"),s=0;s<i.length;s++){var r=i[s],o=r.indexOf(": ");if(o>0){var a=r.substring(0,o),c=r.substring(o+2);n[a]=c}}var u=new Array,l=new Object;return l[e]=n,u.push(l),u},e.prototype.getHeader=function(e){for(var t=new Array,n=this._headers.length,i=0;i<n;i++){var s,r=this._headers[i];for(var o in r)if(r.hasOwnProperty(o)){s=o;var a=r[o],c=o;o.lastIndexOf("/")!==-1&&(c=o.substring(o.lastIndexOf("/")+1)),this.isSuccess()&&this._checksumMapper&&this._checksumMapper[c]&&a&&!a["Content-MD5"]&&(a["Content-MD5"]=this._checksumMapper[c]);for(var u in a)if(a.hasOwnProperty(u)&&u&&e&&u.trim().toLowerCase()===e.trim().toLowerCase()){var l=new Object;l.url=s,l.headerKey=u,l.headerValue=a[u],t.push(l);break}}}return t},e.prototype.getContentVersion=function(e){if(!this._payload)return null;for(var t in this._payload)if(t.indexOf(e)!==-1)return this._payload[t].contentVersion;return null},e.prototype.getContentChecksum=function(e){if(!this._payload)return null;for(var t in this._payload)if(t.indexOf(e)!==-1)return this._payload[t].checksum;return null},e.prototype.getContentMd5Header=function(e,t){if(!e)return null;for(var n=0;n<e.length;n++)if(e[n].url===t)return e[n].headerValue;return null},e.prototype.getUrlHeaderByValue=function(e,t){for(var n=0;n<e.length;n++)if(e[n].url===t)return e[n].headerValue;return null},e.prototype.resolveToRemoteFlavorOrTestDefUrl=function(e){return e&&e.indexOf(window.TestEngine.getNativeComponent().getSecureLocalUrl())!==-1&&(e=e.replace(window.TestEngine.getNativeComponent().getSecureLocalUrl(),window.TestEngine.getNativeComponent().getSecureRemoteUrl())),e},e.prototype.resolveToRemotePreloadUrl=function(e){var t=window.TestEngine.getNativeComponent().getSecureLocalUrl(),n=window.TestEngine.getNativeComponent().getSecureRemoteUrl();if(e&&e.indexOf(n)===-1){var i=e;e.indexOf(t)!==-1&&(i=e.substring(t+t.length));for(var s in this._payload)if(s.indexOf(i)!==-1)return s}return e},e.prototype.validate=function(){var e=new Object,t=window.TestEngine;if("getItemFlavor"===this._command||"getTestDef"===this._command){var n=this.getHeader("Content-MD5")[0],i=this.getHeader("tn-native-generated-md5")[0],s=this.getHeader("Content-Version")[0],r=this.getHeader("Age")[0];if(s?this.getHeader("x-amz-meta-content-version").length>0&&(s=s.concat(this.getHeader("x-amz-meta-content-version")[0])):s=this.getHeader("x-amz-meta-content-version")[0],n&&i&&n.headerValue!==i.headerValue)return e.success="no",e.msg="The test content is corrupted. Please exit the test and notify your test administrator. Url: "+this.resolveToRemoteFlavorOrTestDefUrl(n.url)+", Content MD5: "+n.headerValue+", Generated MD5: "+i.headerValue,e.validationError=t.constructor.MD5_CHECKSUM_MISMATCH,e.msgCode="1010",e;var o=this._payload;if(o||(o=TestEngine.getAuthentication().getCurrentForm().getContentVersion()),s&&s.headerValue!==o)return e.success="no",e.msg="The form has been modified. Please exit the test and notify your test administrator. Url: "+this.resolveToRemoteFlavorOrTestDefUrl(s.url)+", Content Version: "+s.headerValue+", Expected Content Version: "+o+", content MD5: "+(n?n.headerValue:"")+", Generated MD5: "+(i?i.headerValue:"")+", Age: "+(r?r.headerValue:""),e.msgCode="1011",e.validationError=t.constructor.CONTENT_VERSION_MISMATCH,e}else if("preloadResources"===this._command){var n=this.getHeader("Content-MD5");n=n.concat(this.getHeader("x-amz-meta-content-md5"));var i=this.getHeader("tn-native-generated-md5"),s=this.getHeader("Content-Version"),s=this.getHeader("Content-Version");if(s?this.getHeader("x-amz-meta-content-version").length>0&&(s=s.concat(this.getHeader("x-amz-meta-content-version"))):s=this.getHeader("x-amz-meta-content-version"),n&&i)for(var a=n.length,c=i.length,u=0;u<a;u++)for(var l=0;l<c;l++)if(n[u].url===i[l].url&&n[u].headerValue!==i[l].headerValue)return e.success="no",e.msg="The test content is corrupted. Please exit the test and notify your test administrator. Url: "+this.resolveToRemotePreloadUrl(n[u].url)+", content MD5: "+n[u].headerValue+", Generated MD5: "+i[l].headerValue,e.validationError=t.constructor.MD5_CHECKSUM_MISMATCH,e.msgCode="1010",e;if(s&&s.length>0)for(var u=0;u<s.length;u++){var o=this.getContentVersion(s[u].url);if(o||(o=TestEngine.getAuthentication().getCurrentForm().getContentVersion()),s[u]&&s[u].headerValue!==o){var d=this.getContentChecksum(s[u].url),g=this.getUrlHeaderByValue(n,s[u].url);if(d&&d===g)continue;var p=this.getUrlHeaderByValue(this.getHeader("Age"),s[u].url);return e.success="no",e.msg="The form has been modified. Please exit the test and notify your test administrator. Url: "+this.resolveToRemotePreloadUrl(s[u].url)+", Content Version: "+s[u].headerValue+", Expected Content Version: "+o+", CheckSum From Flavor : "+d+", Content Md5: "+g+", Age: "+(p?p:""),e.msgCode="1011",e.validationError=t.constructor.CONTENT_VERSION_MISMATCH,e}}}else if("getAllStates"===this._command||"setMultipleItemStates"===this._command||"exitTest"===this._command||"submitTest"===this._command){var h=this.getHeader("X-Pearson-Message");if(h.length>0)return JSON.parse(h[0].headerValue)}return e.success="yes",e},e}();t.Response=n}),define("SRFManager",["require","exports"],function(e,t){var n=function(){function e(){}return e.prototype.storeTestStateToFile=function(e,t,n,i,s){var r=window.TestEngine;r.storeTestStateFailed=!0;var o={sessionToken:r.getAuthentication().getSessionToken(),userName:r.getAuthentication().getUserName(),studentName:r.getAuthentication().getFirstName()+" "+r.getAuthentication().getLastName(),formId:r.getAuthentication().getFormId(),loginId:r.getAuthentication().getLoginId(),testState:e,testStateVersion:r._state._testStateVersion+1,testnavEventQueue:r._testnavEventQueue,lastClientActivity:r.getCurrentServerTime(),itemState:[]};$.each(r._responseQueue,function(e,t){var n=e.substring(0,e.indexOf("@")),i={itemId:parseInt(n),state:t.data.state,version:t.version,itemOrder:t.itemOrder,timeStamp:t.timestamp};o.itemState.push(i)});var a=function(){if(s)try{window.TestEngine._ewsRetrySucessfullCallback.call(window.TestEngine)}catch(e){}},c=function(){r.stopSRFTimeout(),window.TestEngine._native.checkForBlackList(),a(),t({success:"yes"})},u=function(e,t,n){r.stopSRFTimeout(),r.storeTestStateFailed=!0,r.ewsError(r,'{"success":"no","errorcode":"1004","msg":"Unable to save response file"}',r._ewsReryFunc,r._ewsReryFuncArgs,!0),r._isResponseSendingInProgress=!1};if(r._state.getPracticeTestMode()){$.parseJSON('{"success":"yes", "msg":"State not saved due to practice mode"}');return void t({success:"yes"})}r.startSRFTimeout(),r._isAppMode()?r.isJXBrowserApp()?r._native.saveResponseFile(r._staticKey,JSON.stringify(o),u,null,c):r._native.saveResponseFile(r._staticKey,JSON.stringify(o),r._ewsReryFunc,r._ewsReryFuncArgs,c):r._native.saveResponseFile(r._staticKey,o,u,null,c)},e.prototype.restoreResponsesToFile=function(e,t,n){var i=window.TestEngine;i.restoreResponsesQueued=!0;var s=e.itemState;i._state._lastSavedTestState=e.testState,"undefined"!=typeof e.testnavEventQueue&&(i._testnavEventQueue=e.testnavEventQueue),i._state._testStateVersion++;for(var r=e.lastClientActivity,o=0;o<s.length;o++){var a=s[o].itemId+"@"+((new Date).getTime()+o),c=new Object;c.data=new Object,c.data.state=s[o].state,c.version=s[o].version,c.itemOrder=s[o].itemOrder,c.timestamp=s[o].timeStamp,i._responseQueue[a]=c}s.length>0&&i._state.bufferItemResponses(s);var u={sessionToken:i.getAuthentication().getSessionToken(),userName:i.getAuthentication().getUserName(),studentName:i.getAuthentication().getFirstName()+" "+i.getAuthentication().getLastName(),formId:i.getAuthentication().getFormId(),loginId:i.getAuthentication().getLoginId(),testState:e.testState,testStateVersion:i._state._testStateVersion,testnavEventQueue:i._testnavEventQueue,lastClientActivity:r,itemState:[]};$.each(i._responseQueue,function(e,t){var n=e.substring(0,e.indexOf("@")),i={itemId:parseInt(n),state:t.data.state,version:t.version,itemOrder:t.itemOrder,timeStamp:t.timestamp};u.itemState.push(i)});var l=function(e){if("yes"!==e.success)return void i.ewsError(i,'{"success":"no","errorcode":"1020","msg":"Failed to save to server on resume with SRF"}',i._ewsReryFunc,i._ewsReryFuncArgs);for(var n in i._responseQueue)delete i._responseQueue[n];t.call(window,e)},d=function(){i._state.flushItemBundle(l,!1,window)};i._ewsReryFuncArgs=[e,t],i._ewsReryFunc=function(e,t){window.TestEngine.restoreResponsesToFile(e,t,!0)};var g=function(e,t,n){i.ewsError(i,'{"success":"no","errorcode":"1004","msg":"Unable to save response file"}',i._ewsReryFunc,i._ewsReryFuncArgs,!0)};$(document).trigger("tn.srfUploaded",{sessionToken:e.sessionToken,fixedSRF:e.ignoreTokenValidation,direct:!1}),i._isAppMode()?i.isJXBrowserApp()?i._native.saveResponseFile(i._staticKey,JSON.stringify(u),g,null,d):i._native.saveResponseFile(i._staticKey,JSON.stringify(u),i._ewsReryFunc,i._ewsReryFuncArgs,d):i._native.saveResponseFile(i._staticKey,u,g,null,d)},e.prototype.notifyEWSSuccessIfRetry=function(e,t){if(t)try{e._ewsRetrySucessfullCallback.call(e)}catch(e){}},e.prototype.storeSuccessCallback=function(e,t,n){e.stopSRFTimeout(),this.notifyEWSSuccessIfRetry(e,n),e.storeResponsesFailed=!1,e.storeTestStateFailed=!1,e._shouldChangeLastActivity=!0,t.call(e,{success:"yes"})},e.prototype.storeFailureCallback=function(e,t,n,i,s,r,o,a,c,u,l){if(e.stopSRFTimeout(),e._native.checkForBlackList(),a<2){a++;var d=$.proxy(this.storeFailureCallback,this,e,t,n,i,s,r,o,a,c,u,l);return e.startSRFTimeout(),void(e._isAppMode()?e.isJXBrowserApp()?e._native.saveResponseFile(e._staticKey,JSON.stringify(o),d,null,i):e._native.saveResponseFile(e._staticKey,JSON.stringify(o),e._ewsReryFunc,e._ewsReryFuncArgs,i):e._native.saveResponseFile(e._staticKey,o,d,null,i))}if(!c)return e.ewsError(e,'{"success":"no","errorcode":"1004","msg":"Unable to save response file"}',l,[],!0),void(e._isResponseSendingInProgress=!1);var g=$.proxy(e.saveStateCallback,e,e,u,t,s,!1,l);e._state.transmitState(e,t,e.StateLib.TestEngine.State.ITEM,g,null,!1,!0,!0,u)},e.prototype._constructStoreResponse=function(e,t){var n={sessionToken:e.getAuthentication().getSessionToken(),userName:e.getAuthentication().getUserName(),studentName:e.getAuthentication().getFirstName()+" "+e.getAuthentication().getLastName(),formId:e.getAuthentication().getFormId(),loginId:e.getAuthentication().getLoginId(),testState:t.data.test_state,testnavEventQueue:e._testnavEventQueue,testStateVersion:e._state._testStateVersion+1,lastClientActivity:e.getCurrentServerTime(),itemState:[]};return $.each(e._pendingResponseQueueList,function(e,t){var i=e.substring(0,e.indexOf("@")),s={itemId:parseInt(i),state:t.data.state,version:t.version,itemOrder:t.itemOrder,timeStamp:t.timestamp};n.itemState.push(s)}),$.each(e._responseQueue,function(e,t){var i=e.substring(0,e.indexOf("@")),s={itemId:parseInt(i),state:t.data.state,version:t.version,itemOrder:t.itemOrder,timeStamp:t.timestamp};n.itemState.push(s)}),n},e.prototype.storeResponsesToFile=function(e,t,n,i,s,r,o,a){var e=window.TestEngine;if("yes"===a.success)return void n.call(e._state,a);e._isResponseSendingInProgress=!1,e._shouldChangeLastActivity=!0;var c=this._constructStoreResponse(e,JSON.parse(JSON.stringify(t)));for(var u in e._pendingResponseQueueList)delete e._pendingResponseQueueList[u];var l=(e._navigation.getNavigator(e.getNavigation().getCurrentSection()),JSON.stringify(c.itemState).length,0),d="9999"===a.error,g=$.proxy(this.storeSuccessCallback,this,e,n,s),p=$.proxy(this.storeFailureCallback,this,e,t,n,g,i,s,c,l,d,r,o);return e._state.getPracticeTestMode()?void this.storeSuccessCallback.call(this,e,n,s):(e.startSRFTimeout(),void(e._isAppMode()?e.isJXBrowserApp()?e._native.saveResponseFile(e._staticKey,JSON.stringify(c),p,null,g):e._native.saveResponseFile(e._staticKey,JSON.stringify(c),e._ewsReryFunc,e._ewsReryFuncArgs,g):e._native.saveResponseFile(e._staticKey,c,p,null,g)))},e.prototype.getResponseDecoratedForSRF=function(){var e=window.TestEngine,t={sessionToken:e.getAuthentication().getSessionToken(),userName:e.getAuthentication().getUserName(),studentName:e.getAuthentication().getFirstName()+" "+e.getAuthentication().getLastName(),formId:e.getAuthentication().getFormId(),loginId:e.getAuthentication().getLoginId(),testState:e._state._lastSavedTestState,lastClientActivity:e.getCurrentServerTime(),itemState:[]};return $.each(e._responseQueue,function(e,n){var i=e.substring(0,e.indexOf("@")),s={itemId:parseInt(i),state:n.data.state,version:n.version,itemOrder:n.itemOrder,timeStamp:n.timestamp};t.itemState.push(s)}),t},e.prototype.validateSRF=function(e,t){var n=window.TestEngine;return(e.ignoreTokenValidation===!0||e.sessionToken===n.getAuthentication().getLastSessionToken())&&(e.formId===n.selectedFormId&&(e.loginId===n.selectedLoginId&&!(!e.ignoreTokenValidation&&t&&e.testStateVersion&&e.testStateVersion<=window.TestEngine._state._testStateVersion)))},e.prototype.getTestStateFromSRF=function(e,t,n,i){var s=window.TestEngine;if(s._shouldSkip){if(i)return void e.call(t,void 0);var r=function(n){return n.success&&"no"===n.success.toLowerCase()?void window.TestEngine.dispatchPreTestFailureError(n):(s.afterAuthSelect(n),void e.call(t,void 0))};return void s.initializeEnvironmentForTestSelection(r)}var o=function(r){if(s._srfVerified=!0,i)return void(n?e.apply(s,n):e.call(t,r));var o=function(i){return i.success&&"no"===i.success.toLowerCase()?void window.TestEngine.dispatchPreTestFailureError(i):(s.afterAuthSelect(i),void(n?e.apply(s,n):e.call(t,r)))};s.initializeEnvironmentForTestSelection(o)},a=function(t){return s.stopSRFTimeout(),t||s._isFullySecured?void(t&&!s.validateSRF(t)?s._isFullySecured?(s._srfVerified=!0,o(t)):s.ewsError(s,'{"success":"no","errorcode":"1007","msg":"SRF is invalid - cannot load responses from local file system."}',e,n):(s._srfVerified=!0,o(t))):void s.ewsError(s,'{"success":"no","errorcode":"1006","msg":"SRF is corrupt - cannot load responses from local file system."}',e,n)},c={};if(c.success=a,c.error=function(r,o,a){if(s.stopSRFTimeout(),"parsererror"===o)if(s._isFullySecured){if(s._srfVerified=!0,i)return void(n?e.apply(s,n):e.call(t,null));var c=function(i){return i.success&&"no"===i.success.toLowerCase()?void window.TestEngine.dispatchPreTestFailureError(i):(s.afterAuthSelect(i),void(n?e.apply(s,n):e.call(t,null)))};s.initializeEnvironmentForTestSelection(c)}else s.ewsError(s,'{"success":"no","errorcode":"1006","msg":"SRF is corrupt - cannot load responses from local file system."}',e,n);else try{var u=JSON.parse(r.responseText);if(1021!==parseInt(u.errorcode))s.ewsError(s,r.responseText,e,n);else{if(1021===parseInt(u.errorcode)&&s._formData&&"F"===s._formData.testStatusInd)return void s.ewsError(s,'{"success":"no","errorcode":"1005","msg":"SRF not found - cannot load responses from local file system."}',e,n);if(s._srfVerified=!0,i)return void(n?e.apply(s,n):e.call(t,null));var c=function(i){return i.success&&"no"===i.success.toLowerCase()?void window.TestEngine.dispatchPreTestFailureError(i):(s.afterAuthSelect(i),void(n?e.apply(s,n):e.call(t,void 0)))};s.initializeEnvironmentForTestSelection(c)}}catch(n){e.call(t,{success:"no",msg:"Call to applet has failed."})}},s._isAppMode()){var u=function(t){if(s.stopSRFTimeout(),s._srfVerified||t===!0){if(i)return void e.call(s,t);var n=function(n){return n.success&&"no"===n.success.toLowerCase()?void window.TestEngine.dispatchPreTestFailureError(n):(s.afterAuthSelect(n),void e.call(s,t))};s.initializeEnvironmentForTestSelection(n)}};if(s.isChromeApp()||s.isAndroidApp()||s.isWebView())s.startSRFTimeout(),s._native.loadResponseFile(s.getAuthentication().getLastSessionToken()+".SRF",s._staticKey,u);else if(s.isJXBrowserApp){var l=function(t){s.stopSRFTimeout();var n=function(t){if(!s._srfTimeoutCalled)if(s.stopSRFTimeout(),t===!0&&(s._srfVerified=!0),s._srfVerified){var i=function(n){return n.success&&"no"===n.success.toLowerCase()?void window.TestEngine.dispatchPreTestFailureError(n):(s.afterAuthSelect(n),void e.call(s,t))};s.initializeEnvironmentForTestSelection(i)}else s.startSRFTimeout(),s._native.loadResponseFile(s.getAuthentication().getLastSessionToken()+".SRF",s._staticKey,n)};s.startSRFTimeout(),s._native.loadResponseFile(s.getAuthentication().getLastSessionToken()+".SRF",s._staticKey,n)};window.TestEngine._oldSRFBackupPath?(s.startSRFTimeout(),s._native.setSRFBackupPath(l,l,window.TestEngine._oldSRFBackupPath.srfPrimaryBackup,window.TestEngine._oldSRFBackupPath.srfAlternateBackup)):l(null)}}else s.startSRFTimeout(),s._native.loadResponseFile(s.getAuthentication().getLastSessionToken()+".SRF",s._staticKey,c)},e.prototype.checkForSRFState=function(e,t,n){var i=window.TestEngine;if(i._srfVerified||null===i.getAuthentication().getLastSessionToken()||void 0===i.getAuthentication().getLastSessionToken())null===i.getAuthentication().getLastSessionToken()&&(i._srfVerified=!0),e.apply(t,n);else{var s=function(s){s&&(i._srfVerified=s,i._shouldSkip=s===!0),e.apply(t,n)};i.getTestStateFromSRF(s,window,void 0,!0)}},e}();t.SRFManager=n}),define("EngineDiagnostics",["require","exports"],function(e,t){var n=function(){function e(){this._s3UrlTestCompleted=!1,this._publishContentDirBase="",this._cloudClipboardOptions={}}return e.prototype.testProxy=function(e,t,n,i,s,r,o){var a=t,c=function(){var t=function(e){a.length>0?c():i.apply(r,s)},u=function(t){if(window.TestEngine.proxySetIgnore=!0,e.proctorCacheFailOver+""!="true"||o){window.TestEngine.logError("Proxy Test Failed for Url "+t.url);var a=function(){n.call(r,t)};window.TestEngine._native.postProxyFail(a)}else{window.TestEngine.logError("Test would continue in proctorCacheFailOver mode, Proxy Test Failed for Url "+t.url+", ProxyDetails: "+e.proxyserver+":"+e.proxyport+", Login Id:"+window.TestEngine.selectedLoginId),window.TestEngine.proctorCacheBypassFE={event:window.TestEngine.constructor.PROCOTOR_CACHE_BYPASSED,proxyserver:e.proxyserver,proxyport:e.proxyport,loginId:window.TestEngine.selectedLoginId};var c=function(e){"yes"===e.success?i.apply(r,s):n.call(r,e)};window.TestEngine._native.clearProxy(c)}},l=a[0];return a=a.slice(1),window.TestEngine.UtilsLib.TestEngine.Utils.isValidProctorCacheIp(e.proxyserver)?void window.TestEngine._native.setProxy(e,l,t,u):void u({url:l})};c()},e.prototype.testS3Url=function(e,t,n){var i=e,s=this;i=i.substring(i.indexOf("://")+1),t--,console.log("S3 Url Connection Test - Retry # "+t);var r=function(e,t,i){s._s3UrlTestCompleted=!0,n.call(window.TestEngine,!0)},o=function(i,r,o){t>0?s.testS3Url(e,t,n):n.call(window.TestEngine,!1)};s.makeRequest(i,r,o,"GET")},e.prototype.makeRequest=function(e,t,n,i){var s=this,e=window.TestEngine.UtilsLib.TestEngine.Utils.addUniqueQueryParam(e),r={};r.context=s,r.type="HEAD",i&&(r.type=i),r.timeout=15e3,r.success=t,r.error=n,r.beforeSend=function(e,t){e.url=t.url},$.ajax(e,r)},e.prototype.appCheck=function(e,t){var n=this,i=function(t,i,s){if("no"===t.success)return void e.call(window,{success:"no",msgCode:t.msgCode,msg:t.msg});var r;try{t.configuration&&(r=JSON.parse(t.configuration))}catch(e){}n._publishContentDirBase=t.publishContentDirBase,n.startAppcheck(e,r)},s=function(t,n,i){e.call(window,{success:"no",msgCode:"5040",msg:"There was an error in starting App Check. Please Retry."})},r={};r.context=n,r.type="GET",r.timeout=15e3,r.dataType="json",r.success=i,r.error=s;var o="id";if(t){if(t.indexOf("/")!==-1||t.indexOf("\\")!==-1)return void e.call(window,{success:"no",msgCode:"9110",msg:"No configuration found for given identifier"});o=o+"/"+encodeURIComponent(t)}var a=window.TestEngine.getHttpsUrl("http://"+window.location.host+"/api/8.8/config/client/"+o);$.ajax(a,r)},e.prototype.startAppcheck=function(e,t){var n=this,i=new Array;window.TestEngine._native.isAppCheckInProgress=!0,i.push(n.setupCloudClipboardCheck),i.push(n.appcheckKioskModeTest),i.push(n.appCheckDefaultConnectionTest),i.push(n.blackListTestForOSDefaults),i.push(n.verifyCloudClipboardHistory),i.push(n.verifyCloudClipboardRoaming),i.push(n.appCheckConfigConnectionTest),i.push(n.blackListTest),i.push(n.appCheckSRFTest);var s=[],r=function(o){if(o)if("[object Array]"===Object.prototype.toString.call(o))for(var a=0;a<o.length;a++)s.push(o[a]);else s.push(o);if(i.length>0){var c=i[0];return i=i.slice(1),void c.apply(n,[r,t])}var u=function(t){window.TestEngine._native.isAppCheckInProgress=!1,e.call(window,{success:"yes",report:s})};window.TestEngine._native.postAppCheckCleanUp(u)};r(null)},e.prototype.appcheckKioskModeTest=function(e,t){var n=this,i=n.buildReportRow("KioskMode"),s=function(t){i.setStatus(t),e.call(n,i)};window.TestEngine._native.appCheckKioskMode(s)},e.prototype.appCheckDefaultConnectionTest=function(e,t){var n=this.getUrListToTest(),i=this,s=i.buildReportRow("ConnectivityToTestNav"),r=function(){var t=function(t){n.length>0?r():(s.setStatus(!0),e.call(i,s))},o=function(t){window.TestEngine.logError("Appcheck Default Connection Test failed for url  "+t.url),s.setStatus(!1),s.setDetails(t.url),e.call(i,s)},a=n[0];n=n.slice(1);var c="HEAD";a.indexOf(window.TestEngine.getS3FileName())!==-1&&(c="GET"),i.makeRequest(a,t,o,c)};r()},e.prototype.appCheckConfigConnectionTest=function(e,t){var n=this,i=this.getUrListToTest(!0),s=n.buildReportRow("ProctorCache"),r=function(){s.setStatus(!0),e.call(n,s)},o=function(t){s.setStatus(!1),s.setDetails(t.url),e.call(n,s)};t&&t.proxyserver&&t.proxyport?this.testProxy(t,i,o,r,null,this,!0):e.call(n,null)},e.prototype.blackListTestForOSDefaults=function(e,t){var n=this,i=window.TestEngine.getNativeComponent().addDefaultBlacklistProcessesToConfig(i),s=function(t){if("yes"===t.success){var s=function(t){var s=t.blacklistIndex;if(s===-1)e.call(n,null);else{for(var r=window.TestEngine.getNativeComponent().getBlackListProcesses(s,i),o=(r.split(","),new Array),a=window.TestEngine._native.greylist,c=0;c<a.length;c++)if(r.indexOf(a[c].processName)!==-1){var u=n.buildReportRow(a[c].appcheckTitle);u.setDetails(a[c].details),o.push(u)}o.length>0?e.call(n,o):e.call(n,null)}};window.TestEngine.getNativeComponent().verifyForBlackList(s)}else e.call(n,null)};return window.TestEngine.getNativeComponent().isBlackListSupported()&&i&&i.blacklist&&i.blacklist.length>0?void window.TestEngine.getNativeComponent().setBlackListProcesses(s,i.blacklist.join(",")):void e.call(n,null)},e.prototype.blackListTest=function(e,t){var n=this,i=n.buildReportRow("Blacklist"),s=function(s){if("yes"===s.success){var r=function(s){var r,o=s.blacklistIndex;o!==-1?(r=window.TestEngine._native.getBlackListProcesses(o,t),i.setDetails(r)):i.setStatus(!0),e.call(n,i)};window.TestEngine.getNativeComponent().verifyForBlackList(r)}else e.call(n,i)};return window.TestEngine.getNativeComponent().isBlackListSupported()&&t&&t.blacklist&&"[object Array]"===Object.prototype.toString.call(t.blacklist)&&t.blacklist.join(",").trim().length>0?void window.TestEngine.getNativeComponent().setBlackListProcesses(s,t.blacklist.join(",")):void e.call(n,null)},e.prototype.setupCloudClipboardCheck=function(e,t){var n=this;n._cloudClipboardOptions={};var i=function(e){n._cloudClipboardOptions=e};window.TestEngine._native.registerCloudClipboardCallback(i),e.call(n,null)},e.prototype.verifyCloudClipboardHistory=function(e,t){var n=this.buildReportRow("CloudClipboardHistory");n.status=!0,this._cloudClipboardOptions.isHistoryEnabled?(n.status=!1,e.call(this,n)):e.call(this,null)},e.prototype.verifyCloudClipboardRoaming=function(e,t){var n=this.buildReportRow("CloudClipboardRoaming");n.status=!0,this._cloudClipboardOptions.isRoamingEnabled?(n.status=!1,e.call(this,n)):e.call(this,null)},e.prototype.appCheckSRFTest=function(e,t){var n=this;if(!t)return void e.call(n,null);var i=JSON.stringify(t);if(!window.TestEngine._native.isSrfTestApplicable(i))return void e.call(n,null);var s=window.TestEngine._native.extractSRFLocation(i),r=function(t){for(var i=new Array,s=0;s<t.length;s++){var r=n.buildReportRow("SRFTest");r.status=t[s].status,r.details=t[s].location,r.type=t[s].type,i.push(r)}window.TestEngine._native.clearSRFLocation(),e.call(n,i)};window.TestEngine._native.srfTestAppcheck(s,r)},e.prototype.getUrListToTest=function(e){var t,n;e?(t="http://"+window.location.host+"/"+window.TN8.getNoneCacheableFName(),n="http://"+this._publishContentDirBase+"/"+window.TestEngine.getS3FileName()):(t=window.location.protocol+"//"+window.location.host+"/"+window.TN8.getNoneCacheableFName(),n=window.location.protocol+"//"+this._publishContentDirBase+"/"+window.TestEngine.getS3FileName());var i=[];return i.push(t),i.push(n),i},e.prototype.buildReportRow=function(e){var t={test:e,status:!1,details:"",setStatus:function(e){this.status=e},setDetails:function(e){this.details=e}};return t},e.prototype.cleanUp=function(){this._s3UrlTestCompleted=!1},e}();t.EngineDiagnostics=n}),define("EngineDependantLibs",["./Navigation","./State","./ServerInterface","./JSTreeToQTI","./TestInformation/AssessmentTest","./Response","./SRFManager","./EngineDiagnostics"],function(){return{Navigation:arguments[0],State:arguments[1],ServerInterface:arguments[2],JSTreeToQTI:arguments[3],AssessmentTest:arguments[4],Response:arguments[5],SRFManager:arguments[6],EngineDiagnostics:arguments[7]}});
